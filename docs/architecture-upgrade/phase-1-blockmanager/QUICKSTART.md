# BlockManager V2 å¿«é€Ÿå¯åŠ¨æŒ‡å—

## ğŸ¯ 5 åˆ†é’Ÿå¿«é€Ÿæµ‹è¯•

### æ­¥éª¤ 1ï¼šå¯ç”¨æ–°ç‰ˆæœ¬

ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼š

```typescript
// ğŸ“ src/shared/config/featureFlags.ts

export const FeatureFlags = {
  USE_BLOCK_MANAGER_V2: true,              // â¬…ï¸ æ”¹ä¸º true
  ENABLE_PERFORMANCE_MONITORING: true,      // â¬…ï¸ æ”¹ä¸º true
  ENABLE_VERBOSE_LOGGING: false,
} as const;
```

### æ­¥éª¤ 2ï¼šå¯åŠ¨åº”ç”¨

```bash
npm run dev
# æˆ–
yarn dev
```

### æ­¥éª¤ 3ï¼šæ‰“å¼€æ§åˆ¶å°

æŒ‰ `F12` æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·

### æ­¥éª¤ 4ï¼šå¼€å§‹ç›‘æ§

åœ¨æ§åˆ¶å°è¾“å…¥ï¼š

```javascript
window.startPerformanceMonitoring()
```

### æ­¥éª¤ 5ï¼šå‘é€æ¶ˆæ¯

åœ¨èŠå¤©ç•Œé¢å‘é€ä¸€æ¡æ¶ˆæ¯ï¼Œç­‰å¾… AI å“åº”å®Œæˆ

### æ­¥éª¤ 6ï¼šæŸ¥çœ‹ç»“æœ

åœ¨æ§åˆ¶å°è¾“å…¥ï¼š

```javascript
window.stopPerformanceMonitoring()
```

## âœ… é¢„æœŸç»“æœ

æ§åˆ¶å°åº”è¯¥æ˜¾ç¤ºï¼š

```
============================================================
[PerformanceMonitor] æ€§èƒ½ç›‘æ§ç»“æœ
============================================================
æ€»è€—æ—¶: 3215ms
Redux æ›´æ–°æ¬¡æ•°: 18        âœ… < 20 (ç›®æ ‡)
ç»„ä»¶æ¸²æŸ“æ¬¡æ•°: 18          âœ… < 50 (ç›®æ ‡)
æ•°æ®åº“å†™å…¥æ¬¡æ•°: 9         âœ… < 10 (ç›®æ ‡)
å¹³å‡æ›´æ–°é—´éš”: 178.61ms
============================================================
âœ… æ€§èƒ½æµ‹è¯•é€šè¿‡
```

## ğŸ”„ åˆ‡æ¢å›æ—§ç‰ˆæœ¬

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œå¯ä»¥å¿«é€Ÿåˆ‡æ¢å›æ—§ç‰ˆæœ¬ï¼š

```typescript
// src/shared/config/featureFlags.ts
export const FeatureFlags = {
  USE_BLOCK_MANAGER_V2: false,  // â¬…ï¸ æ”¹å› false
  // ...
}
```

åˆ·æ–°é¡µé¢å³å¯ã€‚

## ğŸ“Š å¯¹æ¯”æµ‹è¯•

### æµ‹è¯•æ—§ç‰ˆæ€§èƒ½

1. è®¾ç½® `USE_BLOCK_MANAGER_V2: false`
2. åˆ·æ–°é¡µé¢
3. è¿è¡Œæ€§èƒ½ç›‘æ§
4. è®°å½•ç»“æœ

### æµ‹è¯•æ–°ç‰ˆæ€§èƒ½

1. è®¾ç½® `USE_BLOCK_MANAGER_V2: true`
2. åˆ·æ–°é¡µé¢
3. è¿è¡Œæ€§èƒ½ç›‘æ§
4. è®°å½•ç»“æœ

### å¯¹æ¯”

| ç‰ˆæœ¬ | Redux æ›´æ–° | æ¸²æŸ“æ¬¡æ•° | ä½“éªŒ |
|------|-----------|---------|------|
| V1 æ—§ç‰ˆ | ~1000 | ~1000 | å¡é¡¿ |
| V2 æ–°ç‰ˆ | ~18 | ~18 | æµç•… |
| **æ”¹è¿›** | **98%â†“** | **98%â†“** | **âœ…** |

## ğŸ› é‡åˆ°é—®é¢˜ï¼Ÿ

### é—®é¢˜ 1ï¼šæ§åˆ¶å°æ‰¾ä¸åˆ° `window.startPerformanceMonitoring`

**è§£å†³**ï¼šç¡®ä¿å·²å¯ç”¨ `ENABLE_PERFORMANCE_MONITORING`

### é—®é¢˜ 2ï¼šæ€§èƒ½æ²¡æœ‰æ”¹å–„

**æ£€æŸ¥**ï¼š
1. ç¡®è®¤ `USE_BLOCK_MANAGER_V2: true`
2. ç¡®è®¤å·²åˆ·æ–°é¡µé¢
3. æŸ¥çœ‹æ§åˆ¶å°æ˜¯å¦æœ‰ `[ResponseHandler] ä½¿ç”¨ V2 (BlockManager)` æ—¥å¿—

### é—®é¢˜ 3ï¼šåŠŸèƒ½å¼‚å¸¸

**æ“ä½œ**ï¼š
1. ç«‹å³åˆ‡æ¢å› `USE_BLOCK_MANAGER_V2: false`
2. è®°å½•é”™è¯¯æ—¥å¿—
3. æŸ¥çœ‹ [testing-guide.md](./testing-guide.md) è¯¦ç»†è°ƒè¯•

## ğŸ“ å¿«é€Ÿæ£€æŸ¥æ¸…å•

å¯åŠ¨æµ‹è¯•å‰ï¼Œç¡®è®¤ï¼š

- [ ] å·²ä¿®æ”¹ `featureFlags.ts`
- [ ] å·²é‡å¯å¼€å‘æœåŠ¡å™¨
- [ ] å·²åˆ·æ–°æµè§ˆå™¨é¡µé¢
- [ ] æ§åˆ¶å°æ— æŠ¥é”™
- [ ] èƒ½çœ‹åˆ° `[ResponseHandler]` æ—¥å¿—

## ğŸ”— æ›´å¤šä¿¡æ¯

- [å®Œæ•´æµ‹è¯•æŒ‡å—](./testing-guide.md)
- [ä½¿ç”¨ç¤ºä¾‹](./BlockManager-usage-example.md)
- [æ€§èƒ½å¯¹æ¯”è¯¦æƒ…](./performance-comparison.md)

---

**æç¤º**ï¼šç¬¬ä¸€æ¬¡æµ‹è¯•å»ºè®®ä½¿ç”¨ç®€å•çš„æ–‡æœ¬æ¶ˆæ¯ï¼Œé¿å…å¤æ‚åœºæ™¯å¹²æ‰°æµ‹è¯•ç»“æœã€‚
