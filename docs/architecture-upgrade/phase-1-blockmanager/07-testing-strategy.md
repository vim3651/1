# 测试策略

## 🎯 目标

- 单元测试覆盖率 > 90%
- 集成测试覆盖核心流程  
- 性能测试验证优化效果

## 🧪 测试分层

### 1. 单元测试（90%+）

**BlockManager**
- 块创建测试
- 智能更新策略测试
- 节流逻辑测试

**Chunk 适配器**
- Chunk 转换测试
- 错误处理测试
- 各 Provider 适配器测试

**插件系统**
- 插件钩子执行测试
- 插件优先级测试
- 错误隔离测试

### 2. 集成测试

**完整流程**
- 用户发送 → AI 响应
- 工具调用流程
- 多轮对话
- 流式响应

### 3. 性能测试

**关键指标**
- 1000 chunks → Redux 更新 < 50 次
- 处理时间 < 1 秒
- 内存增长 < 100MB

### 4. 回归测试

**功能检查**
- 所有 Provider 基本功能
- 工具调用
- 思考过程
- 多模态
- 流式输出

## 📊 覆盖率目标

| 模块 | 单元测试 | 集成测试 |
|------|----------|----------|
| BlockManager | 95% | ✅ |
| Chunk 适配器 | 90% | ✅ |
| 插件系统 | 90% | ✅ |
| Provider | 85% | ✅ |

## 🔧 测试工具

- Vitest - 单元测试
- React Testing Library - 组件测试
- MSW - API Mock
- Playwright - E2E 测试

## 🔗 相关文档

- [迁移检查清单](./08-migration-checklist.md)
