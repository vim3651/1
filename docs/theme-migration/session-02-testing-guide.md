# 会话 2：Material-UI Theme 适配层改造 - 测试指南

**日期：** 2025-11-05

## 测试目标

验证 Material-UI Theme 配置正确使用 CSS Variables，确保所有主题风格在亮色/暗色模式下都能正常工作。

## 测试环境准备

1. 启动开发服务器
2. 打开浏览器开发者工具
3. 准备测试所有 5 个主题风格：default, claude, nature, tech, soft
4. 准备测试亮色/暗色模式切换

## 测试清单

### 1. CSS Variables 注入测试

**测试步骤：**
1. 打开浏览器开发者工具 → Elements/元素
2. 查看 `<html>` 元素的 computed styles
3. 确认所有 `--theme-*` CSS Variables 都已正确注入

**预期结果：**
- ✅ `--theme-primary` 存在且有值
- ✅ `--theme-secondary` 存在且有值
- ✅ `--theme-bg-default` 存在且有值
- ✅ `--theme-bg-paper` 存在且有值
- ✅ `--theme-text-primary` 存在且有值
- ✅ `--theme-text-secondary` 存在且有值
- ✅ `--theme-border-default` 存在且有值
- ✅ 其他所有定义的变量都存在

### 2. 主题切换测试

**测试步骤：**
1. 进入设置页面
2. 依次切换所有 5 个主题风格
3. 观察页面颜色变化

**测试主题：**

#### 2.1 Default 主题
- [ ] 主色调为灰蓝色 (#64748B)
- [ ] 次要色为绿色 (#10B981)
- [ ] 背景色为白色/深灰
- [ ] 文字颜色正常
- [ ] Paper 组件背景色正确

#### 2.2 Claude 主题
- [ ] 主色调为橙色 (#D97706)
- [ ] 背景色为米色/深棕色
- [ ] Paper 组件有温暖的米色背景
- [ ] 文字颜色与背景有良好对比度
- [ ] 侧边栏颜色正确

#### 2.3 Nature 主题
- [ ] 主色调为森林绿 (#2D5016)
- [ ] 背景色为温暖的米白/深绿黑
- [ ] 自然的大地色调
- [ ] 文字清晰可读
- [ ] 按钮颜色正确

#### 2.4 Tech 主题
- [ ] 主色调为科技蓝 (#3B82F6)
- [ ] 背景色为淡蓝白/深蓝黑
- [ ] 冷色调科技感
- [ ] 文字颜色正确
- [ ] 输入框样式正确

#### 2.5 Soft 主题
- [ ] 主色调为粉红色 (#EC4899)
- [ ] 背景色为淡粉色/深紫色
- [ ] 柔和的渐变效果
- [ ] 文字颜色正确
- [ ] 整体温暖舒适

### 3. 亮色/暗色模式切换测试

**测试步骤：**
1. 在每个主题下切换亮色/暗色模式
2. 观察颜色变化是否流畅
3. 检查文字对比度

**预期结果：**
- [ ] 所有 5 个主题在亮色模式下正常显示
- [ ] 所有 5 个主题在暗色模式下正常显示
- [ ] 切换模式时 CSS Variables 立即更新
- [ ] 没有闪烁或延迟
- [ ] 文字始终清晰可读

### 4. Material-UI 组件测试

#### 4.1 Paper 组件
- [ ] 背景色使用 `--theme-bg-paper`
- [ ] 不同主题下颜色正确
- [ ] 阴影效果正确（特定主题）

#### 4.2 Button 组件
- [ ] Primary 按钮使用渐变背景
- [ ] 渐变来自 `--theme-gradient-primary`
- [ ] Hover 状态正常
- [ ] 文字颜色正确

#### 4.3 TextField 组件
- [ ] 背景色使用 `--theme-input-bg`
- [ ] 边框颜色使用 `--theme-input-border`
- [ ] Hover 状态边框颜色正确
- [ ] Focus 状态边框颜色正确
- [ ] Placeholder 颜色正确

#### 4.4 Drawer/Sidebar 组件
- [ ] 背景色使用 `--theme-sidebar-bg`
- [ ] 边框颜色正确
- [ ] ListItemButton hover 状态正确
- [ ] ListItemButton selected 状态正确

#### 4.5 AppBar 组件
- [ ] 背景色正确
- [ ] 半透明效果正常
- [ ] 模糊效果（backdrop-filter）生效

### 5. 全局样式测试

**测试步骤：**
1. 检查 body 背景色
2. 检查 #root 背景色
3. 检查全局文字颜色

**预期结果：**
- [ ] body 使用 `--theme-bg-default`
- [ ] #root 使用 `--theme-bg-default`
- [ ] 没有硬编码的颜色值冲突

### 6. 视觉回归测试

**测试步骤：**
1. 对比会话 1 完成后的页面截图
2. 确保没有视觉上的变化

**预期结果：**
- [ ] 页面整体外观与之前一致
- [ ] 没有引入新的视觉问题
- [ ] 颜色准确无误

### 7. 性能测试

**测试步骤：**
1. 打开浏览器性能监控
2. 快速切换主题 10 次
3. 观察响应时间和内存使用

**预期结果：**
- [ ] 主题切换响应时间 < 100ms
- [ ] 没有明显的性能下降
- [ ] 内存使用稳定

### 8. 边界情况测试

**测试场景：**
- [ ] 页面刷新后主题保持
- [ ] 快速连续切换主题不出错
- [ ] 在不同页面切换主题都正常
- [ ] 开发者工具中手动修改 CSS Variables 会立即生效

## 常见问题排查

### 问题 1：CSS Variables 未注入
**检查：**
- `useTheme.ts` 中的 `applyCSSVariables` 是否被调用
- `AppContent.tsx` 中是否正确初始化
- 浏览器控制台是否有错误

### 问题 2：颜色不正确
**检查：**
- Design Tokens 定义是否正确
- CSS Variable 名称是否匹配
- 是否有旧的硬编码颜色覆盖

### 问题 3：主题切换不生效
**检查：**
- Redux state 是否正确更新
- `useTheme` hook 是否正确响应
- CSS Variables 是否重新注入

### 问题 4：Material-UI 组件样式异常
**检查：**
- `createCustomTheme` 是否使用 `cssVar()`
- Material-UI 组件配置是否正确
- 是否有其他样式覆盖

## 测试完成标准

- ✅ 所有 5 个主题在亮色/暗色模式下都正常显示
- ✅ CSS Variables 正确注入且动态更新
- ✅ Material-UI 组件使用 CSS Variables
- ✅ 没有视觉回归
- ✅ 性能达标
- ✅ 没有控制台错误

## 测试报告模板

```markdown
## 测试结果

**测试日期：** YYYY-MM-DD
**测试人员：** XXX
**测试环境：** Chrome/Firefox/Safari

### 主题测试结果
- [ ] Default 主题：通过/失败
- [ ] Claude 主题：通过/失败
- [ ] Nature 主题：通过/失败
- [ ] Tech 主题：通过/失败
- [ ] Soft 主题：通过/失败

### 模式切换测试
- [ ] 亮色模式：通过/失败
- [ ] 暗色模式：通过/失败
- [ ] 模式切换：通过/失败

### 组件测试结果
- [ ] Paper：通过/失败
- [ ] Button：通过/失败
- [ ] TextField：通过/失败
- [ ] Drawer：通过/失败
- [ ] AppBar：通过/失败

### 性能测试结果
- 主题切换响应时间：XXms
- 内存使用：正常/异常

### 发现的问题
1. [描述问题]
2. [描述问题]

### 总体评价
通过/需要修复
```

---

**最后更新：** 2025-11-05

