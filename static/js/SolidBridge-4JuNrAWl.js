import{qp as e,xp as t,zp as n}from"./index-hvLbsAjx.js";import{C as r,h as i,m as a,s as o,v as s,w as c}from"./web-DV3rYUP8.js";var l=Symbol(`store-raw`),u=Symbol(`store-node`),d=Symbol(`store-has`),f=Symbol(`store-self`);function p(e){let t=e[a];if(!t&&(Object.defineProperty(e,a,{value:t=new Proxy(e,x)}),!Array.isArray(e))){let n=Object.keys(e),r=Object.getOwnPropertyDescriptors(e);for(let i=0,a=n.length;i<a;i++){let a=n[i];r[a].get&&Object.defineProperty(e,a,{enumerable:r[a].enumerable,get:r[a].get.bind(t)})}}return t}function m(e){let t;return typeof e==`object`&&!!e&&(e[a]||!(t=Object.getPrototypeOf(e))||t===Object.prototype||Array.isArray(e))}function h(e,t=new Set){let n,r,i,a;if(n=e!=null&&e[l])return n;if(!m(e)||t.has(e))return e;if(Array.isArray(e)){Object.isFrozen(e)?e=e.slice(0):t.add(e);for(let n=0,a=e.length;n<a;n++)i=e[n],(r=h(i,t))!==i&&(e[n]=r)}else{Object.isFrozen(e)?e=Object.assign({},e):t.add(e);let n=Object.keys(e),o=Object.getOwnPropertyDescriptors(e);for(let s=0,c=n.length;s<c;s++)a=n[s],!o[a].get&&(i=e[a],(r=h(i,t))!==i&&(e[a]=r))}return e}function g(e,t){let n=e[t];return n||Object.defineProperty(e,t,{value:n=Object.create(null)}),n}function _(e,t,n){if(e[t])return e[t];let[i,a]=r(n,{equals:!1,internal:!0});return i.$=a,e[t]=i}function v(e,t){let n=Reflect.getOwnPropertyDescriptor(e,t);return!n||n.get||!n.configurable||t===a||t===u?n:(delete n.value,delete n.writable,n.get=()=>e[a][t],n)}function y(e){c()&&_(g(e,u),f)()}function b(e){return y(e),Reflect.ownKeys(e)}var x={get(e,t,n){if(t===l)return e;if(t===a)return n;if(t===i)return y(e),n;let r=g(e,u),o=r[t],s=o?o():e[t];if(t===u||t===d||t===`__proto__`)return s;if(!o){let n=Object.getOwnPropertyDescriptor(e,t);c()&&(typeof s!=`function`||e.hasOwnProperty(t))&&!(n&&n.get)&&(s=_(r,t,s)())}return m(s)?p(s):s},has(e,t){return t===l||t===a||t===i||t===u||t===d||t===`__proto__`?!0:(c()&&_(g(e,d),t)(),t in e)},set(){return!0},deleteProperty(){return!0},ownKeys:b,getOwnPropertyDescriptor:v};function S(e,t,n,r=!1){if(!r&&e[t]===n)return;let i=e[t],a=e.length;n===void 0?(delete e[t],e[d]&&e[d][t]&&i!==void 0&&e[d][t].$()):(e[t]=n,e[d]&&e[d][t]&&i===void 0&&e[d][t].$());let o=g(e,u),s;if((s=_(o,t,i))&&s.$(()=>n),Array.isArray(e)&&e.length!==a){for(let t=e.length;t<a;t++)(s=o[t])&&s.$();(s=_(o,`length`,a))&&s.$(e.length)}(s=o[f])&&s.$()}function C(e,t){let n=Object.keys(t);for(let r=0;r<n.length;r+=1){let i=n[r];S(e,i,t[i])}}function w(e,t){if(typeof t==`function`&&(t=t(e)),t=h(t),Array.isArray(t)){if(e===t)return;let n=0,r=t.length;for(;n<r;n++){let r=t[n];e[n]!==r&&S(e,n,r)}S(e,`length`,r)}else C(e,t)}function T(e,t,n=[]){let r,i=e;if(t.length>1){r=t.shift();let a=typeof r,o=Array.isArray(e);if(Array.isArray(r)){for(let i=0;i<r.length;i++)T(e,[r[i]].concat(t),n);return}else if(o&&a===`function`){for(let i=0;i<e.length;i++)r(e[i],i)&&T(e,[i].concat(t),n);return}else if(o&&a===`object`){let{from:i=0,to:a=e.length-1,by:o=1}=r;for(let r=i;r<=a;r+=o)T(e,[r].concat(t),n);return}else if(t.length>1){T(e[r],t,[r].concat(n));return}i=e[r],n=[r].concat(n)}let a=t[0];typeof a==`function`&&(a=a(i,n),a===i)||r===void 0&&a==null||(a=h(a),r===void 0||m(i)&&m(a)&&!Array.isArray(a)?C(i,a):S(e,r,a))}function E(...[e,t]){let n=h(e||{}),r=Array.isArray(n),i=p(n);function a(...e){s(()=>{r&&e.length===1?w(n,e[0]):T(n,e)})}return[i,a]}var D=e(n(),1),O=e(t(),1);function k(e,t){let n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(let r of n)if(e[r]!==t[r])return!1;return!0}function A(e){if(typeof e!=`object`||!e||e instanceof Date||e instanceof Error||typeof e==`function`)return e;if(e instanceof Array)return e.map(A);try{return JSON.parse(JSON.stringify(e))}catch{return{...e}}}function j(e){return(...t)=>e(...t.map(A))}function M({component:e,props:t={},style:n,className:r,onUnmount:i,propsAreEqual:a=k,debug:s=!1,debugName:c=`SolidBridge`,onError:l,eventBus:u}){let d=(0,D.useRef)(null),f=(0,D.useRef)(null),p=(0,D.useRef)(null),[m,h]=(0,D.useState)(null),[g,_]=(0,D.useState)(!1),v=(0,D.useRef)(t),y=(0,D.useRef)(0),b=(0,D.useCallback)((e,...t)=>{s&&console.log(`[${c}]`,e,...t)},[s,c]),x=(0,D.useCallback)(e=>{console.error(`[${c}] 错误:`,e),h(e),l?.(e)},[c,l]);return(0,D.useEffect)(()=>{if(d.current){y.current++,b(`初始化 SolidJS 组件 (渲染次数: ${y.current})`);try{let n={};for(let e in t){let r=t[e];typeof r==`function`?n[e]=j(r):n[e]=A(r)}let[r,i]=E(n);p.current={store:r,setStore:i},f.current=o(()=>{try{return e(u?{...p.current.store,$eventBus:u}:p.current.store)}catch(e){return x(e),null}},d.current),_(!0),b(`SolidJS 组件渲染成功`)}catch(e){x(e)}return()=>{b(`卸载 SolidJS 组件`),f.current&&=(f.current(),null),p.current=null,i?.(),_(!1)}}},[e]),(0,D.useEffect)(()=>{if(!g||!p.current)return;let{setStore:e}=p.current,n=v.current;if(a(n,t)){b(`Props 未变化，跳过更新`);return}b(`响应式更新 Props`,{prev:n,next:t});try{let r={};for(let e in t)if(t[e]!==n[e]){let i=t[e];typeof i==`function`?r[e]=j(i):r[e]=A(i),s&&b(`  - ${e}:`,n[e],`→`,t[e])}for(let e in n)e in t||(r[e]=void 0,s&&b(`  - ${e}: 已删除`));e(r),v.current=t}catch(e){x(e)}},[t,g,a,s,b,x]),m?(0,O.jsxs)(`div`,{className:r,style:{...n,padding:`20px`,backgroundColor:`#fee`,border:`2px solid #c33`,borderRadius:`8px`,color:`#c33`},children:[(0,O.jsx)(`h3`,{style:{margin:`0 0 10px 0`},children:`❌ SolidJS 组件错误`}),(0,O.jsxs)(`p`,{style:{margin:0,fontSize:`14px`},children:[(0,O.jsxs)(`strong`,{children:[c,`:`]}),` `,m.message]}),s&&(0,O.jsx)(`pre`,{style:{marginTop:`10px`,padding:`10px`,backgroundColor:`#fff`,border:`1px solid #c33`,borderRadius:`4px`,fontSize:`12px`,overflow:`auto`},children:m.stack})]}):(0,O.jsx)(`div`,{ref:d,className:r,style:n,"data-solid-bridge":`true`,"data-solid-bridge-name":c,"data-solid-bridge-ready":g})}D.memo(M,(e,t)=>e.component!==t.component||e.className!==t.className||e.debug!==t.debug||e.debugName!==t.debugName?!1:(t.propsAreEqual||k)(e.props||{},t.props||{}));export{M as t};