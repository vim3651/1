import{t as e}from"./Card-CgnXHdbl.js";import{i as t,n as ee,r as n,t as r}from"./backgroundUtils-DcaDtnMt.js";import{t as i}from"./file-text-BSjgZddV.js";import{t as a}from"./image-7oImefSY.js";import{t as o}from"./quote-CbtT0pf9.js";import{$t as s,Ad as c,Cd as l,Du as u,Gl as d,Iu as f,Nu as p,Ou as m,Qt as h,Qu as g,Sd as _,Su as v,Ud as y,Xl as b,Yr as x,_ as te,bd as ne,ci as re,fd as S,i as C,jd as w,ju as T,ku as E,pp as D,qd as O,qp as k,s as A,wl as j,xd as M,xp as N,xu as P,zp as F}from"./index-hvLbsAjx.js";var I=v(`panels-top-left`,[[`rect`,{width:`18`,height:`18`,x:`3`,y:`3`,rx:`2`,key:`afitv7`}],[`path`,{d:`M3 9h18`,key:`1pudct`}],[`path`,{d:`M9 21V9`,key:`1oto5p`}]]),L=k(F(),1),R=k(N(),1),z=()=>{let{t:v}=re(),k=D(),N=h(),F=y(),z=s(e=>e.settings),{containerRef:B,handleScroll:V}=C(`settings-chat-interface`,{autoRestore:!0,restoreDelay:100}),[H,U]=(0,L.useState)(``),[W,G]=(0,L.useState)(!1),K=(0,L.useRef)(null),q=z.multiModelDisplayStyle||`horizontal`,J=z.showToolDetails!==!1,ie=z.showCitationDetails!==!1,Y=z.showSystemPromptBubble!==!1,X=z.chatBackground||{enabled:!1,imageUrl:``,opacity:.7,size:`cover`,position:`center`,repeat:`no-repeat`,showOverlay:!0},ae=()=>{k(`/settings/appearance`)},oe=e=>{N(x({multiModelDisplayStyle:e.target.value}))},se=e=>{N(x({showToolDetails:e.target.checked}))},ce=e=>{N(x({showCitationDetails:e.target.checked}))},le=e=>{N(x({showSystemPromptBubble:e.target.checked}))},ue=e=>{N(x({chatBackground:{...X,enabled:e.target.checked}}))},de=(e,t)=>{N(x({chatBackground:{...X,opacity:t}}))},fe=e=>{N(x({chatBackground:{...X,size:e.target.value}}))},pe=e=>{N(x({chatBackground:{...X,position:e.target.value}}))},me=e=>{N(x({chatBackground:{...X,repeat:e.target.value}}))},he=e=>{N(x({chatBackground:{...X,showOverlay:e.target.checked}}))},ge=async e=>{let t=e.target.files?.[0];if(t){U(``),G(!0);try{let e=n(t,v);if(!e.valid){U(e.error||v(`settings.appearance.chatInterface.background.errors.validationFailed`));return}let i=await ee(t);X.imageUrl&&r(X.imageUrl),N(x({chatBackground:{...X,imageUrl:i,enabled:!0}}))}catch(e){U(v(`settings.appearance.chatInterface.background.errors.uploadFailed`)),console.error(`Background upload error:`,e)}finally{G(!1),K.current&&(K.current.value=``)}}},_e=()=>{X.imageUrl&&r(X.imageUrl),N(x({chatBackground:{...X,imageUrl:``,enabled:!1}}))},ve=()=>{K.current?.click()},Z={mb:2,p:2.5,borderRadius:3,border:`1px solid`,borderColor:`divider`,bgcolor:`background.paper`,boxShadow:`none`,transition:`all 0.2s ease-in-out`,"&:hover":{borderColor:O(F.palette.primary.main,.3),bgcolor:O(F.palette.background.paper,.8)}},Q={display:`flex`,alignItems:`center`,justifyContent:`space-between`,gap:2},$=(e=20)=>{let t=z.fontSize/16;return Math.round(e*t)};return(0,R.jsxs)(te,{children:[(0,R.jsx)(ne,{position:`static`,elevation:0,sx:{bgcolor:`background.paper`,color:`text.primary`,borderBottom:1,borderColor:`divider`,backdropFilter:`blur(8px)`},children:(0,R.jsxs)(u,{children:[(0,R.jsx)(l,{edge:`start`,color:`inherit`,onClick:ae,"aria-label":`back`,sx:{color:e=>e.palette.primary.main,mr:1},children:(0,R.jsx)(P,{size:$(20)})}),(0,R.jsx)(M,{variant:`h6`,component:`div`,sx:{flexGrow:1,fontWeight:600},children:v(`settings.appearance.chatInterface.title`)})]})}),(0,R.jsxs)(S,{ref:B,onScroll:V,sx:{flexGrow:1,overflowY:`auto`,p:{xs:2,sm:3},pb:`var(--content-bottom-padding)`,"&::-webkit-scrollbar":{width:{xs:`4px`,sm:`6px`}},"&::-webkit-scrollbar-thumb":{backgroundColor:`rgba(0,0,0,0.1)`,borderRadius:`3px`}},children:[(0,R.jsxs)(c,{sx:Z,children:[(0,R.jsxs)(S,{sx:{mb:2,display:`flex`,alignItems:`center`,gap:1.5},children:[(0,R.jsx)(S,{sx:{p:1,borderRadius:2,bgcolor:O(F.palette.primary.main,.1),color:F.palette.primary.main},children:(0,R.jsx)(I,{size:$(20)})}),(0,R.jsxs)(S,{children:[(0,R.jsxs)(S,{sx:{display:`flex`,alignItems:`center`,gap:1},children:[(0,R.jsx)(M,{variant:`subtitle1`,fontWeight:600,children:v(`settings.appearance.chatInterface.multiModel.title`)}),(0,R.jsx)(E,{title:v(`settings.appearance.chatInterface.multiModel.tooltip`),children:(0,R.jsx)(b,{size:$(16),className:`text-gray-400 hover:text-gray-600 cursor-help`})})]}),(0,R.jsx)(M,{variant:`body2`,color:`text.secondary`,children:v(`settings.appearance.chatInterface.multiModel.description`)})]})]}),(0,R.jsx)(g,{fullWidth:!0,variant:`outlined`,size:`small`,children:(0,R.jsxs)(p,{value:q,onChange:oe,sx:{borderRadius:2},children:[(0,R.jsx)(f,{value:`horizontal`,children:v(`settings.appearance.chatInterface.multiModel.horizontal`)}),(0,R.jsx)(f,{value:`vertical`,children:v(`settings.appearance.chatInterface.multiModel.vertical`)}),(0,R.jsx)(f,{value:`single`,children:v(`settings.appearance.chatInterface.multiModel.single`)})]})})]}),(0,R.jsxs)(m,{spacing:2,mb:3,children:[(0,R.jsx)(c,{sx:Z,children:(0,R.jsxs)(S,{sx:Q,children:[(0,R.jsxs)(S,{sx:{display:`flex`,gap:2,flex:1},children:[(0,R.jsx)(S,{sx:{p:1,height:`fit-content`,borderRadius:2,bgcolor:O(`#6366f1`,.1),color:`#6366f1`},children:(0,R.jsx)(d,{size:$(20)})}),(0,R.jsxs)(S,{children:[(0,R.jsxs)(S,{sx:{display:`flex`,alignItems:`center`,gap:1},children:[(0,R.jsx)(M,{variant:`subtitle1`,fontWeight:600,children:v(`settings.appearance.chatInterface.toolCall.title`)}),(0,R.jsx)(E,{title:v(`settings.appearance.chatInterface.toolCall.tooltip`),children:(0,R.jsx)(b,{size:$(16),className:`text-gray-400 hover:text-gray-600 cursor-help`})})]}),(0,R.jsx)(M,{variant:`body2`,color:`text.secondary`,sx:{mt:.5},children:v(`settings.appearance.chatInterface.toolCall.description`)})]})]}),(0,R.jsx)(A,{checked:J,onChange:se})]})}),(0,R.jsx)(c,{sx:Z,children:(0,R.jsxs)(S,{sx:Q,children:[(0,R.jsxs)(S,{sx:{display:`flex`,gap:2,flex:1},children:[(0,R.jsx)(S,{sx:{p:1,height:`fit-content`,borderRadius:2,bgcolor:O(`#10b981`,.1),color:`#10b981`},children:(0,R.jsx)(o,{size:$(20)})}),(0,R.jsxs)(S,{children:[(0,R.jsxs)(S,{sx:{display:`flex`,alignItems:`center`,gap:1},children:[(0,R.jsx)(M,{variant:`subtitle1`,fontWeight:600,children:v(`settings.appearance.chatInterface.citation.title`)}),(0,R.jsx)(E,{title:v(`settings.appearance.chatInterface.citation.tooltip`),children:(0,R.jsx)(b,{size:$(16),className:`text-gray-400 hover:text-gray-600 cursor-help`})})]}),(0,R.jsx)(M,{variant:`body2`,color:`text.secondary`,sx:{mt:.5},children:v(`settings.appearance.chatInterface.citation.description`)})]})]}),(0,R.jsx)(A,{checked:ie,onChange:ce})]})}),(0,R.jsx)(c,{sx:Z,children:(0,R.jsxs)(S,{sx:Q,children:[(0,R.jsxs)(S,{sx:{display:`flex`,gap:2,flex:1},children:[(0,R.jsx)(S,{sx:{p:1,height:`fit-content`,borderRadius:2,bgcolor:O(`#f59e0b`,.1),color:`#f59e0b`},children:(0,R.jsx)(i,{size:$(20)})}),(0,R.jsxs)(S,{children:[(0,R.jsx)(M,{variant:`subtitle1`,fontWeight:600,children:v(`settings.appearance.chatInterface.systemPrompt.title`)}),(0,R.jsx)(M,{variant:`body2`,color:`text.secondary`,sx:{mt:.5},children:v(`settings.appearance.chatInterface.systemPrompt.description`)})]})]}),(0,R.jsx)(A,{checked:Y,onChange:le})]})})]}),(0,R.jsxs)(c,{sx:Z,children:[(0,R.jsxs)(S,{sx:Q,children:[(0,R.jsxs)(S,{sx:{display:`flex`,gap:2,flex:1},children:[(0,R.jsx)(S,{sx:{p:1,height:`fit-content`,borderRadius:2,bgcolor:O(`#ec4899`,.1),color:`#ec4899`},children:(0,R.jsx)(a,{size:$(20)})}),(0,R.jsxs)(S,{children:[(0,R.jsx)(M,{variant:`subtitle1`,fontWeight:600,children:v(`settings.appearance.chatInterface.background.title`)}),(0,R.jsx)(M,{variant:`body2`,color:`text.secondary`,sx:{mt:.5},children:v(`settings.appearance.chatInterface.background.description`)})]})]}),(0,R.jsx)(A,{checked:X.enabled,onChange:ue})]}),(0,R.jsx)(w,{in:X.enabled,children:(0,R.jsxs)(S,{sx:{mt:3,pt:3,borderTop:`1px dashed`,borderColor:`divider`},children:[(0,R.jsxs)(S,{sx:{mb:3},children:[(0,R.jsx)(M,{variant:`subtitle2`,sx:{mb:1.5,fontWeight:600},children:v(`settings.appearance.chatInterface.background.imageLabel`)}),(0,R.jsx)(S,{sx:{display:`flex`,gap:2,flexWrap:`wrap`},children:X.imageUrl?(0,R.jsxs)(e,{sx:{width:200,position:`relative`,borderRadius:2,overflow:`visible`,boxShadow:`0 4px 12px rgba(0,0,0,0.1)`},children:[(0,R.jsx)(t,{component:`img`,height:`120`,image:X.imageUrl,alt:`Preview`,sx:{borderRadius:2,objectFit:`cover`}}),(0,R.jsx)(l,{size:`small`,onClick:_e,sx:{position:`absolute`,top:-8,right:-8,bgcolor:`error.main`,color:`white`,"&:hover":{bgcolor:`error.dark`},boxShadow:`0 2px 4px rgba(0,0,0,0.2)`},children:(0,R.jsx)(j,{size:$(14)})})]}):(0,R.jsxs)(S,{onClick:ve,sx:{width:`100%`,height:120,border:`2px dashed`,borderColor:`divider`,borderRadius:2,display:`flex`,flexDirection:`column`,alignItems:`center`,justifyContent:`center`,cursor:`pointer`,transition:`all 0.2s`,"&:hover":{borderColor:`primary.main`,bgcolor:O(F.palette.primary.main,.02)}},children:[(0,R.jsx)(a,{size:$(32),style:{color:F.palette.text.secondary,marginBottom:8}}),(0,R.jsx)(M,{variant:`body2`,color:`text.secondary`,fontWeight:500,children:v(W?`settings.appearance.chatInterface.background.uploading`:`settings.appearance.chatInterface.background.uploadHint`)}),(0,R.jsx)(M,{variant:`caption`,color:`text.disabled`,children:v(`settings.appearance.chatInterface.background.uploadFormat`)})]})}),(0,R.jsx)(`input`,{ref:K,type:`file`,accept:`image/*`,onChange:ge,style:{display:`none`}}),H&&(0,R.jsx)(_,{severity:`error`,sx:{mt:2,borderRadius:2},children:H})]}),(0,R.jsxs)(S,{sx:{display:`grid`,gridTemplateColumns:{xs:`1fr`,sm:`1fr 1fr`},gap:3},children:[(0,R.jsxs)(S,{sx:{gridColumn:`1 / -1`},children:[(0,R.jsxs)(S,{sx:{display:`flex`,justifyContent:`space-between`,mb:1},children:[(0,R.jsx)(M,{variant:`subtitle2`,fontWeight:600,children:v(`settings.appearance.chatInterface.background.opacityLabel`)}),(0,R.jsxs)(M,{variant:`caption`,color:`text.secondary`,fontWeight:500,children:[Math.round(X.opacity*100),`%`]})]}),(0,R.jsx)(T,{value:X.opacity,onChange:de,min:.1,max:1,step:.1,marks:[{value:.1,label:`10%`},{value:.5,label:`50%`},{value:1,label:`100%`}]})]}),(0,R.jsx)(S,{sx:{gridColumn:`1 / -1`},children:(0,R.jsxs)(S,{sx:{display:`flex`,alignItems:`center`,justifyContent:`space-between`,p:2,borderRadius:2,bgcolor:`action.hover`},children:[(0,R.jsxs)(S,{children:[(0,R.jsx)(M,{variant:`subtitle2`,fontWeight:600,children:`显示渐变遮罩`}),(0,R.jsx)(M,{variant:`caption`,color:`text.secondary`,children:`在背景上方添加白色渐变遮罩，提高文字可读性。关闭后可直接通过透明度控制背景`})]}),(0,R.jsx)(A,{checked:X.showOverlay!==!1,onChange:he})]})}),(0,R.jsxs)(g,{fullWidth:!0,size:`small`,children:[(0,R.jsx)(M,{variant:`subtitle2`,sx:{mb:1,fontWeight:600},children:v(`settings.appearance.chatInterface.background.sizeLabel`)}),(0,R.jsx)(p,{value:X.size,onChange:fe,sx:{borderRadius:2},children:[`cover`,`contain`,`auto`].map(e=>(0,R.jsx)(f,{value:e,children:v(`settings.appearance.chatInterface.background.presets.${e}.label`)},e))})]}),(0,R.jsxs)(g,{fullWidth:!0,size:`small`,children:[(0,R.jsx)(M,{variant:`subtitle2`,sx:{mb:1,fontWeight:600},children:v(`settings.appearance.chatInterface.background.positionLabel`)}),(0,R.jsx)(p,{value:X.position,onChange:pe,sx:{borderRadius:2},children:[`center`,`top`,`bottom`,`left`,`right`].map(e=>(0,R.jsx)(f,{value:e,children:v(`settings.appearance.chatInterface.background.positions.${e}`)},e))})]}),(0,R.jsxs)(g,{fullWidth:!0,size:`small`,children:[(0,R.jsx)(M,{variant:`subtitle2`,sx:{mb:1,fontWeight:600},children:v(`settings.appearance.chatInterface.background.repeatLabel`)}),(0,R.jsxs)(p,{value:X.repeat,onChange:me,sx:{borderRadius:2},children:[(0,R.jsx)(f,{value:`no-repeat`,children:v(`settings.appearance.chatInterface.background.repeats.noRepeat`)}),(0,R.jsx)(f,{value:`repeat`,children:v(`settings.appearance.chatInterface.background.repeats.repeat`)}),(0,R.jsx)(f,{value:`repeat-x`,children:v(`settings.appearance.chatInterface.background.repeats.repeatX`)}),(0,R.jsx)(f,{value:`repeat-y`,children:v(`settings.appearance.chatInterface.background.repeats.repeatY`)})]})]})]})]})})]}),(0,R.jsx)(S,{sx:{height:`40px`}})]})]})};export{z as default};