import{t as e}from"./ListSubheader-K3IOJnRV.js";import{Cd as t,Cu as n,Iu as r,Nu as i,Ud as a,bp as o,bu as s,dd as c,ei as l,fd as u,md as d,ni as f,qp as p,ti as m,xd as h,xp as g,zp as _}from"./index-hvLbsAjx.js";import{t as v}from"./settingsSelectors-BdPnPOZr.js";import{n as y,t as b}from"./providerIcons-C3i_yWyD.js";var x=p(_(),1),S=p(g(),1);const C=({selectedModel:e,onClick:r,displayStyle:i=`icon`})=>{let l=a(),d=n(l.breakpoints.down(`sm`)),f=o(v),p=e=>{let t=f.find(t=>t.id===e);return t?t.name:e},m=e=>{let t=.875,n=.65;if(e.length<=18)return`${t}rem`;let r=e.length/18,i=t*Math.max(1/Math.sqrt(r),n/t);return`${Math.max(i,n)}rem`};if(i===`icon`)return(0,S.jsx)(t,{color:`inherit`,size:`small`,onClick:r,children:(0,S.jsx)(s,{size:20})});let g=e?p(e.provider||``):``,_=e?.name||`GPT-4`;return(0,S.jsx)(c,{variant:`outlined`,size:`small`,onClick:r,sx:{borderColor:`divider`,color:`text.primary`,textTransform:`none`,minWidth:`auto`,px:1.5,py:.5},children:(0,S.jsxs)(u,{sx:{display:`flex`,flexDirection:`column`,alignItems:`flex-start`,minWidth:0},children:[(0,S.jsx)(h,{variant:`body2`,sx:{fontWeight:500,fontSize:m(_),color:l.palette.text.primary,maxWidth:d?`120px`:`none`,overflow:`hidden`,textOverflow:`ellipsis`,whiteSpace:`nowrap`,lineHeight:1.1},title:_,children:_}),g&&(0,S.jsx)(h,{variant:`caption`,sx:{fontSize:`0.65rem`,color:l.palette.text.secondary,lineHeight:1,mt:.25,maxWidth:d?`120px`:`none`,overflow:`hidden`,textOverflow:`ellipsis`,whiteSpace:`nowrap`},title:g,children:g})]})})},w=({selectedModel:t,availableModels:s,handleModelSelect:c,displayStyle:p=`text`})=>{let g=a(),_=n(g.breakpoints.down(`sm`)),w=o(v),T=x.useCallback(e=>{let t=w.find(t=>t.id===e);return t?t.name:e},[w]),E=x.useMemo(()=>{let e={};return s.forEach(t=>{let n=t.provider||t.providerType||`unknown`;e[n]||(e[n]=[]),e[n].push(t)}),{groups:e,sortedGroups:Object.keys(e).sort((e,t)=>{let n=w.findIndex(t=>t.id===e),r=w.findIndex(e=>e.id===t);if(n!==-1&&r!==-1)return n-r;if(n!==-1)return-1;if(r!==-1)return 1;let i=T(e),a=T(t);return i.localeCompare(a)})}},[s,T,w]),D=e=>{let t=e.target.value;if(!(!t||typeof t!=`string`)){j(!1),requestAnimationFrame(()=>{let e=document.activeElement;e?.getAttribute(`role`)===`option`&&e.blur()});try{let e=f(t);if(!e){console.error(`无法解析模型标识:`,t);return}let n=s.find(t=>m(t,e,t.provider));n?setTimeout(()=>{c(n)},0):console.error(`未找到匹配的模型:`,t)}catch(e){console.error(`处理模型选择时出错:`,e)}}},O=x.useCallback(e=>l({id:e.id,provider:e.provider||e.providerType||``}),[]),k=x.useCallback(()=>{if(!t)return``;let e=f(O(t));if(e){let t=s.find(t=>m(t,e,t.provider));if(t)return O(t)}return O(t)},[t,O,s]),[A,j]=x.useState(!1),M=()=>j(!0);return(0,S.jsxs)(u,{sx:{position:`relative`},children:[(0,S.jsx)(C,{selectedModel:t,onClick:M,displayStyle:p}),(0,S.jsxs)(i,{open:A,onClose:()=>j(!1),onOpen:M,value:k(),onChange:D,displayEmpty:!0,renderValue:()=>null,sx:{position:`absolute`,top:0,left:0,width:`100%`,height:`100%`,opacity:0,pointerEvents:A?`auto`:`none`,"& .MuiSelect-select":{padding:0,border:`none`,bgcolor:`transparent`},"& .MuiSelect-icon":{display:`none`},"&:before":{display:`none`},"&:after":{display:`none`},"& .MuiOutlinedInput-notchedOutline":{border:`none`}},MenuProps:{anchorOrigin:{vertical:`bottom`,horizontal:`left`},transformOrigin:{vertical:`top`,horizontal:`left`},slotProps:{paper:{sx:{maxHeight:_?`50vh`:`70vh`,minHeight:_?150:300,width:_?`85vw`:`auto`,maxWidth:_?`85vw`:400,minWidth:_?`300px`:280,mt:.5,..._&&{maxWidth:`calc(100vw - 32px)`,marginLeft:`auto`,marginRight:`auto`},boxShadow:`0 4px 20px rgba(0, 0, 0, 0.1)`,bgcolor:g.palette.mode===`dark`?`#2A2A2A`:g.palette.background.paper,borderRadius:1,"& .MuiList-root":{py:0,bgcolor:`transparent`,"&:focus":{outline:`none`}}}},root:{slotProps:{backdrop:{invisible:!0,sx:{backgroundColor:`transparent`}}}}}},children:[!A&&t&&(0,S.jsx)(r,{value:O(t),sx:{display:`none`}},O(t)),A&&E.sortedGroups.flatMap(t=>{let n=T(t),i=E.groups[t];return[(0,S.jsxs)(e,{sx:{bgcolor:g.palette.mode===`dark`?`#3A3A3A`:`#F5F5F5`,fontWeight:600,fontSize:`0.8rem`,py:.75,px:2,minHeight:32,display:`flex`,alignItems:`center`,gap:.75,position:`sticky`,top:0,zIndex:10,borderBottom:`1px solid ${g.palette.mode===`dark`?`rgba(255, 255, 255, 0.1)`:`rgba(0, 0, 0, 0.1)`}`,"&:not(:first-of-type)":{borderTop:`1px solid ${g.palette.mode===`dark`?`rgba(255, 255, 255, 0.05)`:`rgba(0, 0, 0, 0.05)`}`}},children:[(0,S.jsx)(d,{src:y(t,g.palette.mode===`dark`),alt:n,sx:{width:16,height:16,bgcolor:`transparent`,fontSize:`0.65rem`},children:n[0]}),n]},`header-${t}`),...i.map(e=>{let t=O(e);return(0,S.jsx)(r,{value:t,sx:{py:1,pl:3,pr:2,minHeight:40,bgcolor:`transparent`,"&:hover":{bgcolor:g.palette.mode===`dark`?`rgba(255, 255, 255, 0.08)`:`rgba(0, 0, 0, 0.04)`},"&.Mui-selected":{bgcolor:g.palette.mode===`dark`?`rgba(33, 150, 243, 0.2)`:`rgba(33, 150, 243, 0.1)`,"&:hover":{bgcolor:g.palette.mode===`dark`?`rgba(33, 150, 243, 0.3)`:`rgba(33, 150, 243, 0.15)`}}},children:(0,S.jsxs)(u,{sx:{display:`flex`,alignItems:`center`,gap:1.5,width:`100%`,maxWidth:`100%`},children:[(0,S.jsx)(d,{src:b(e.id,e.provider||e.providerType||``,g.palette.mode===`dark`),alt:e.name,sx:{width:24,height:24,bgcolor:`transparent`,fontSize:`0.7rem`,flexShrink:0},children:e.name[0]}),(0,S.jsxs)(u,{sx:{flex:1,minWidth:0},children:[(0,S.jsx)(h,{variant:`body2`,sx:{fontWeight:500,fontSize:`0.875rem`,lineHeight:1.3,overflow:`hidden`,textOverflow:`ellipsis`,whiteSpace:`nowrap`,maxWidth:`100%`},title:e.name,children:e.name}),e.description&&(0,S.jsx)(h,{variant:`caption`,color:`text.secondary`,sx:{display:`block`,fontSize:`0.75rem`,lineHeight:1.2,mt:.25,overflow:`hidden`,textOverflow:`ellipsis`,whiteSpace:`nowrap`,maxWidth:`100%`},title:e.description,children:e.description})]})]})},t)}).filter(Boolean)].filter(Boolean)})]})]})};var T=w;export{T as n,C as r,w as t};