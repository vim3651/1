import{t as e}from"./InputAdornment-DO0tC8Wv.js";import{t}from"./circle-check-B0NHRkcd.js";import{t as n}from"./circle-x-CT1DTRz7.js";import{t as r}from"./plus-DCrdXXDc.js";import{t as i}from"./shield-DNkeYoa0.js";import{t as a}from"./wifi-D9s-JR6V.js";import{Cd as o,Cn as s,Eu as c,Iu as ee,Nu as te,Ql as l,Qu as u,Sd as d,Sn as f,Vl as p,_ as m,_n as h,bn as g,bp as _,ci as v,dd as y,f as b,fd as x,g as S,gn as ne,hn as re,i as ie,m as ae,mn as C,nu as oe,pn as se,pp as w,qd as T,qp as E,s as ce,tu as le,v as D,vd as ue,vn as de,wd as fe,wl as pe,wn as O,x as k,xd as A,xn as j,xp as M,yn as N,yp as P,zp as F}from"./index-hvLbsAjx.js";var I=E(F(),1),L=E(M(),1),R=()=>{let E=w(),M=P(),{t:F}=v(),{containerRef:R,handleScroll:z}=ie(`settings-network-proxy`,{autoRestore:!0,restoreDelay:0}),{globalProxy:B,isTesting:V,lastTestResult:H,isLoaded:U,status:W}=_(e=>e.networkProxy),[G,me]=(0,I.useState)(!1),[K,he]=(0,I.useState)(`https://www.google.com`),[q,J]=(0,I.useState)(``),[Y,X]=(0,I.useState)(``);(0,I.useEffect)(()=>{U||M(re())},[M,U]);let Z=(0,I.useCallback)(()=>{M(ne({globalProxy:B,status:W,isTesting:!1,isLoaded:!0}))},[M,B,W]);(0,I.useEffect)(()=>{if(U){let e=setTimeout(Z,500);return()=>clearTimeout(e)}},[B,U,Z]);let ge=()=>{E(`/settings`)},_e=async()=>{let e=!B.enabled;M(de(e)),await M(se({...B,enabled:e}))},ve=[{value:`http`,label:`HTTP`},{value:`https`,label:`HTTPS`},{value:`socks4`,label:`SOCKS4`},{value:`socks5`,label:`SOCKS5`}],ye=e=>{M(f(e.target.value)),M(C())},be=e=>{M(N(e.target.value)),M(C())},Q=()=>{let e=Y.trim();if(!e)return;let t=``,n=0,r=null,i=e.match(/^(https?|socks[45]):\/\//i),a=e;if(i){let t=i[1].toLowerCase();t===`http`?r=`http`:t===`https`?r=`https`:t===`socks4`?r=`socks4`:t===`socks5`&&(r=`socks5`),a=e.slice(i[0].length)}let o=a.lastIndexOf(`:`);if(o!==-1){t=a.slice(0,o);let e=a.slice(o+1);n=parseInt(e,10),(isNaN(n)||n<1||n>65535)&&(n=0)}else t=a;t&&M(N(t)),n>0&&M(j(n)),r&&M(f(r)),M(C()),X(``)},xe=e=>{let t=e.target.value;if(t===``){M(j(0)),M(C());return}if(!/^\d+$/.test(t))return;let n=parseInt(t,10);n>=0&&n<=65535&&(M(j(n)),M(C()))},Se=e=>{M(s(e.target.value)),M(C())},Ce=e=>{M(g(e.target.value)),M(C())},we=async()=>{await M(O({config:B,testUrl:K}))},$=()=>{q.trim()&&!B.bypass?.includes(q.trim())&&(M(h([...B.bypass||[],q.trim()])),J(``))},Te=e=>{M(h((B.bypass||[]).filter(t=>t!==e)))},Ee=()=>H?H.success?(0,L.jsxs)(d,{severity:`success`,icon:(0,L.jsx)(t,{size:20}),sx:{mt:2,borderRadius:2},children:[(0,L.jsx)(A,{variant:`body2`,fontWeight:600,children:F(`settings.networkProxy.test.success`)}),H.responseTime&&(0,L.jsx)(A,{variant:`caption`,color:`text.secondary`,children:F(`settings.networkProxy.test.responseTime`,{time:H.responseTime})}),H.externalIp&&(0,L.jsx)(A,{variant:`caption`,display:`block`,color:`text.secondary`,children:F(`settings.networkProxy.test.externalIp`,{ip:H.externalIp})})]}):(0,L.jsxs)(d,{severity:`error`,icon:(0,L.jsx)(n,{size:20}),sx:{mt:2,borderRadius:2},children:[(0,L.jsx)(A,{variant:`body2`,fontWeight:600,children:F(`settings.networkProxy.test.failed`)}),H.error&&(0,L.jsx)(A,{variant:`caption`,color:`text.secondary`,children:H.error})]}):null;return(0,L.jsxs)(m,{children:[(0,L.jsx)(ae,{title:F(`settings.networkProxy.title`),onBackPress:ge}),(0,L.jsx)(b,{ref:R,onScroll:z,sx:{overflow:`auto`,willChange:`scroll-position`,transform:`translateZ(0)`,WebkitOverflowScrolling:`touch`},children:(0,L.jsxs)(k,{sx:{gap:3,pb:4},children:[(0,L.jsx)(x,{sx:e=>({p:2,borderRadius:3,background:e.palette.mode===`dark`?T(e.palette.primary.main,.1):T(e.palette.primary.main,.05),border:`1px solid ${T(e.palette.primary.main,.2)}`}),children:(0,L.jsxs)(S,{sx:{alignItems:`center`,gap:2},children:[(0,L.jsx)(x,{sx:e=>({width:48,height:48,borderRadius:2,display:`flex`,alignItems:`center`,justifyContent:`center`,background:T(e.palette.primary.main,.15)}),children:B.enabled?(0,L.jsx)(i,{size:24,color:`currentColor`}):(0,L.jsx)(l,{size:24,color:`currentColor`})}),(0,L.jsxs)(x,{sx:{flex:1},children:[(0,L.jsx)(A,{variant:`subtitle1`,fontWeight:600,children:B.enabled?F(`settings.networkProxy.status.enabled`):F(`settings.networkProxy.status.disabled`)}),(0,L.jsx)(A,{variant:`caption`,color:`text.secondary`,children:B.enabled?`${B.type.toUpperCase()} - ${B.host}:${B.port}`:F(`settings.networkProxy.status.directConnection`)})]}),(0,L.jsx)(ce,{checked:B.enabled,onChange:_e})]})}),(0,L.jsxs)(D,{title:F(`settings.networkProxy.basic.title`),children:[(0,L.jsxs)(x,{sx:{p:2},children:[(0,L.jsx)(A,{variant:`body2`,color:`text.secondary`,gutterBottom:!0,children:F(`settings.networkProxy.basic.type`)}),(0,L.jsx)(u,{fullWidth:!0,size:`small`,children:(0,L.jsx)(te,{value:B.type,onChange:ye,sx:{borderRadius:2},children:ve.map(e=>(0,L.jsx)(ee,{value:e.value,children:(0,L.jsxs)(S,{sx:{alignItems:`center`,gap:1},children:[(0,L.jsx)(a,{size:16}),(0,L.jsx)(A,{children:e.label})]})},e.value))})})]}),(0,L.jsxs)(x,{sx:{p:2},children:[(0,L.jsx)(A,{variant:`body2`,color:`text.secondary`,gutterBottom:!0,children:F(`settings.networkProxy.basic.quickInput`,`快速填入`)}),(0,L.jsxs)(x,{sx:{display:`flex`,gap:1},children:[(0,L.jsx)(c,{fullWidth:!0,size:`small`,placeholder:`18.162.158.218:80 或 socks5://127.0.0.1:1080`,value:Y,onChange:e=>X(e.target.value),onKeyDown:e=>e.key===`Enter`&&Q(),sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}}),(0,L.jsx)(y,{variant:`outlined`,size:`small`,onClick:Q,disabled:!Y.trim(),sx:{borderRadius:2,minWidth:`auto`,px:2},children:F(`settings.networkProxy.basic.fill`,`填入`)})]}),(0,L.jsx)(A,{variant:`caption`,color:`text.secondary`,sx:{mt:.5,display:`block`},children:F(`settings.networkProxy.basic.quickInputHint`,`支持格式: host:port, http://host:port, socks5://host:port`)})]}),(0,L.jsxs)(x,{sx:{p:2},children:[(0,L.jsx)(A,{variant:`body2`,color:`text.secondary`,gutterBottom:!0,children:F(`settings.networkProxy.basic.host`)}),(0,L.jsx)(c,{fullWidth:!0,size:`small`,placeholder:`127.0.0.1`,value:B.host,onChange:be,sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})]}),(0,L.jsxs)(x,{sx:{p:2},children:[(0,L.jsx)(A,{variant:`body2`,color:`text.secondary`,gutterBottom:!0,children:F(`settings.networkProxy.basic.port`)}),(0,L.jsx)(c,{fullWidth:!0,size:`small`,type:`text`,placeholder:`8080`,value:B.port||``,onChange:xe,inputProps:{inputMode:`numeric`,pattern:`[0-9]*`},sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})]})]}),(0,L.jsx)(D,{title:F(`settings.networkProxy.auth.title`),children:(0,L.jsxs)(x,{sx:{p:2},children:[(0,L.jsx)(A,{variant:`caption`,color:`text.secondary`,sx:{mb:2,display:`block`},children:F(`settings.networkProxy.auth.description`)}),(0,L.jsx)(A,{variant:`body2`,color:`text.secondary`,gutterBottom:!0,children:F(`settings.networkProxy.auth.username`)}),(0,L.jsx)(c,{fullWidth:!0,size:`small`,placeholder:F(`settings.networkProxy.auth.usernamePlaceholder`),value:B.username||``,onChange:Se,sx:{mb:2,"& .MuiOutlinedInput-root":{borderRadius:2}}}),(0,L.jsx)(A,{variant:`body2`,color:`text.secondary`,gutterBottom:!0,children:F(`settings.networkProxy.auth.password`)}),(0,L.jsx)(c,{fullWidth:!0,size:`small`,type:G?`text`:`password`,placeholder:F(`settings.networkProxy.auth.passwordPlaceholder`),value:B.password||``,onChange:Ce,InputProps:{endAdornment:(0,L.jsx)(e,{position:`end`,children:(0,L.jsx)(o,{size:`small`,onClick:()=>me(!G),edge:`end`,children:G?(0,L.jsx)(oe,{size:18}):(0,L.jsx)(le,{size:18})})})},sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})]})}),(0,L.jsx)(D,{title:F(`settings.networkProxy.bypass.title`),children:(0,L.jsxs)(x,{sx:{p:2},children:[(0,L.jsx)(A,{variant:`caption`,color:`text.secondary`,sx:{mb:2,display:`block`},children:F(`settings.networkProxy.bypass.description`)}),(0,L.jsx)(x,{sx:{display:`flex`,flexWrap:`wrap`,gap:1,mb:2},children:(B.bypass||[]).map(e=>(0,L.jsx)(ue,{label:e,size:`small`,onDelete:()=>Te(e),deleteIcon:(0,L.jsx)(pe,{size:14}),sx:{borderRadius:1.5}},e))}),(0,L.jsxs)(S,{sx:{gap:1},children:[(0,L.jsx)(c,{fullWidth:!0,size:`small`,placeholder:F(`settings.networkProxy.bypass.placeholder`),value:q,onChange:e=>J(e.target.value),onKeyPress:e=>e.key===`Enter`&&$(),sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}}),(0,L.jsx)(o,{onClick:$,disabled:!q.trim(),sx:e=>({bgcolor:T(e.palette.primary.main,.1),"&:hover":{bgcolor:T(e.palette.primary.main,.2)}}),children:(0,L.jsx)(r,{size:20})})]})]})}),(0,L.jsx)(D,{title:F(`settings.networkProxy.test.title`),children:(0,L.jsxs)(x,{sx:{p:2},children:[(0,L.jsx)(A,{variant:`caption`,color:`text.secondary`,sx:{mb:2,display:`block`},children:F(`settings.networkProxy.test.description`)}),(0,L.jsx)(A,{variant:`body2`,color:`text.secondary`,gutterBottom:!0,children:F(`settings.networkProxy.test.url`)}),(0,L.jsx)(c,{fullWidth:!0,size:`small`,placeholder:`https://www.google.com`,value:K,onChange:e=>he(e.target.value),sx:{mb:2,"& .MuiOutlinedInput-root":{borderRadius:2}}}),(0,L.jsx)(y,{fullWidth:!0,variant:`outlined`,onClick:we,disabled:V||!B.host||!B.port,startIcon:V?(0,L.jsx)(fe,{size:16}):(0,L.jsx)(p,{size:16}),sx:{borderRadius:2},children:F(V?`settings.networkProxy.test.testing`:`settings.networkProxy.test.button`)}),Ee()]})}),(0,L.jsxs)(d,{severity:`info`,sx:{borderRadius:2},children:[(0,L.jsx)(A,{variant:`body2`,fontWeight:600,gutterBottom:!0,children:F(`settings.networkProxy.platformSupport.title`)}),(0,L.jsxs)(A,{variant:`caption`,component:`div`,children:[`• `,(0,L.jsx)(`strong`,{children:`Android`}),` - `,F(`settings.networkProxy.platformSupport.android`),(0,L.jsx)(`br`,{}),`• `,(0,L.jsx)(`strong`,{children:`iOS`}),` - `,F(`settings.networkProxy.platformSupport.ios`),(0,L.jsx)(`br`,{}),`• `,(0,L.jsx)(`strong`,{children:`Web`}),` - `,F(`settings.networkProxy.platformSupport.web`)]})]})]})})]})};export{R as default};