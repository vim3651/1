import{ei as e,qi as t}from"./index-hvLbsAjx.js";import{C as n,D as r,S as i,_ as a,a as o,b as s,c,f as l,g as u,i as d,n as f,o as p,p as ee,r as m,t as h,x as g,y as _}from"./web-DV3rYUP8.js";import{t as v}from"./providerIcons-C3i_yWyD.js";var te=l(`<div class=solid-multi-quick-select><button class=solid-multi-quick-select-btn><svg width=16 height=16 viewBox="0 0 24 24"fill=none stroke=currentColor stroke-width=2><circle cx=12 cy=12 r=10></circle><polyline points="12 6 12 12 16 14"></polyline></svg>快速选择上次的 <!> 个模型`),y=l(`<div class=solid-multi-selected-tags><span class=solid-multi-selected-label>已选择的模型：</span><div class=solid-multi-tags-container>`),ne=l(`<button class="solid-multi-tab-scroll-button left"aria-label=向左滚动><svg width=24 height=24 viewBox="0 0 24 24"fill=none stroke=currentColor stroke-width=2><polyline points="15 18 9 12 15 6">`),re=l(`<button class="solid-multi-tab-scroll-button right"aria-label=向右滚动><svg width=24 height=24 viewBox="0 0 24 24"fill=none stroke=currentColor stroke-width=2><polyline points="9 18 15 12 9 6">`),ie=l(`<div class=solid-multi-model-list>`),b=l(`<div><div><div class=solid-multi-dialog-header><h2 class=solid-multi-dialog-title><svg width=20 height=20 viewBox="0 0 24 24"fill=none stroke=currentColor stroke-width=2 style=margin-right:8px><path d="M16 3h5v5M8 3H3v5M3 16v5h5M21 16v5h-5M12 12m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0"></path></svg>选择多个模型<span style=margin-left:8px;font-size:12px;color:#90caf9;font-weight:normal>⚡ SolidJS</span></h2><button class=solid-multi-dialog-close-btn aria-label=close><svg width=24 height=24 viewBox="0 0 24 24"fill=none stroke=currentColor stroke-width=2><line x1=18 y1=6 x2=6 y2=18></line><line x1=6 y1=6 x2=18 y2=18></line></svg></button></div><div class=solid-multi-selection-bar><span class=solid-multi-selection-count>已选择 <!> / <!> 个模型</span><div class=solid-multi-action-buttons><button class=solid-multi-action-btn title=全选><svg width=16 height=16 viewBox="0 0 24 24"fill=none stroke=currentColor stroke-width=2><rect x=3 y=3 width=18 height=18 rx=2 ry=2></rect><polyline points="9 11 12 14 22 4"></polyline></svg></button><button class=solid-multi-action-btn title=清空><svg width=16 height=16 viewBox="0 0 24 24"fill=none stroke=currentColor stroke-width=2><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg></button></div></div><div class=solid-multi-tabs-wrapper><div class=solid-multi-tabs-container><div class=solid-multi-tabs><button>全部</button></div></div></div><div class=solid-multi-dialog-content></div><div class=solid-multi-dialog-actions><button class="solid-multi-btn solid-multi-btn-cancel">取消</button><button class="solid-multi-btn solid-multi-btn-confirm"><svg width=16 height=16 viewBox="0 0 24 24"fill=none stroke=currentColor stroke-width=2 style=margin-right:6px><path d="M16 3h5v5M8 3H3v5M3 16v5h5M21 16v5h-5M12 12m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0"></path></svg>发送到 <!> 个模型`),x=l(`<span class=solid-multi-tag> / <button class=solid-multi-tag-remove><svg width=12 height=12 viewBox="0 0 24 24"fill=none stroke=currentColor stroke-width=2><line x1=18 y1=6 x2=6 y2=18></line><line x1=6 y1=6 x2=18 y2=18>`),S=l(`<button>`),C=l(`<div class=solid-multi-empty>没有可用的模型`),w=l(`<div><div class=solid-multi-checkbox><input type=checkbox><span class=solid-multi-checkmark></span></div><div class=solid-multi-model-icon><img><div class=solid-multi-model-icon-fallback style=display:none></div></div><div class=solid-multi-model-info><div></div><div class=solid-multi-model-description>`),T=`multi_model_selector_last_selection`,E=e=>{try{localStorage.setItem(T,JSON.stringify(e))}catch(e){console.warn(`保存多模型选择失败:`,e)}},D=()=>{try{let e=localStorage.getItem(T);return e?JSON.parse(e):[]}catch(e){return console.warn(`加载多模型选择失败:`,e),[]}};function O(c){console.log(`[SolidJS] MultiModelSelector 已加载`);let l=()=>c.maxSelection??5,[d,f]=n([]),[v,w]=n(`all`),[T,O]=n([]),A=t=>{let n=t.provider||t.providerId||`unknown`;return e({id:t.id,provider:n})},j=()=>c.selectedModels!==void 0,M=()=>j()?(c.selectedModels||[]).map(e=>A(e)):d(),N=e=>{let t=typeof e==`function`?e(M()):e;if(j()&&c.onSelectionChange){let e=t.map(e=>c.availableModels.find(t=>A(t)===e)).filter(Boolean);c.onSelectionChange(e)}else f(t)};s(()=>{c.open&&O(D().filter(t=>c.availableModels.some(n=>e({id:n.id,provider:n.provider||n.providerId||`unknown`})===t)))});let[ae,P]=n(!1),[oe,F]=n(!1),[I,L]=n(!1),[R,z]=n(0),[B,V]=n(0),H,U=g(()=>{let e=new Map;return c.providers.forEach(t=>{e.set(t.id,t.name)}),e}),W=e=>U().get(e)||e,G=g(()=>{let e={},t={};c.availableModels.forEach(n=>{let r=n.provider||n.providerType||`未知`,i=W(r);t[r]||(t[r]={id:r,displayName:i}),e[r]||(e[r]=[]),e[r].push(n)});let n=Object.values(t),r=new Map;return c.providers.forEach((e,t)=>{r.set(e.id,t)}),n.sort((e,t)=>{let n=r.get(e.id),i=r.get(t.id);return n!==void 0&&i!==void 0?n-i:n===void 0?i===void 0?e.displayName.localeCompare(t.displayName):1:-1}),{groups:e,providers:n}}),K=g(()=>{let e=v(),t=G().groups;return e===`all`?c.availableModels:t[e]||[]}),q=e=>{let t=A(e);N(e=>e.includes(t)?e.filter(e=>e!==t):e.length>=l()?e:[...e,t])},se=()=>{N(c.availableModels.slice(0,l()).map(e=>A(e)))},ce=()=>{N([])},le=()=>{let e=T();e.length>0&&N(e.slice(0,l()))},ue=()=>{let e=M();e.length>0&&(E(e),c.onClose())},J=()=>{j()||f([]),c.onClose()},Y=()=>{if(!H)return;let{scrollLeft:e,scrollWidth:t,clientWidth:n}=H;P(e>0),F(e+n<t-1)},de=e=>{H&&(e.preventDefault(),H.scrollLeft+=e.deltaY*3,Y())},X=e=>{H&&(L(!0),z(e.pageX-H.offsetLeft),V(H.scrollLeft),H.style.cursor=`grabbing`)},fe=e=>{if(!I()||!H)return;e.preventDefault();let t=(e.pageX-H.offsetLeft-R())*1.5;H.scrollLeft=B()-t},pe=()=>{L(!1),H&&(H.style.cursor=`grab`)},me=()=>{I()&&(L(!1),H&&(H.style.cursor=`grab`))},Z=e=>{if(!H)return;let t=e===`left`?H.scrollLeft-200:H.scrollLeft+200;H.scrollTo({left:t,behavior:`smooth`})};s(()=>{G(),setTimeout(Y,0)}),s(()=>{c.open||(w(`all`),j()||f([]))});let he=e=>{e.target.classList.contains(`solid-multi-dialog-backdrop`)&&J()},Q=`solid-multi-model-selector`;s(()=>{let e=c.open,{openDialog:n,closeDialog:i}=t.getState();e?n(Q,()=>{console.log(`[SolidJS MultiModelSelector] 通过返回键关闭`),J()}):i(Q),r(()=>{e&&i(Q)})});let $=g(()=>M().map(e=>c.availableModels.find(t=>A(t)===e)).filter(Boolean));return _(a,{get when(){return c.open},get children(){return _(h,{get children(){var e=b(),t=e.firstChild,n=t.firstChild,r=n.firstChild.nextSibling,s=n.nextSibling,d=s.firstChild,f=d.firstChild.nextSibling,h=f.nextSibling.nextSibling;h.nextSibling;var g=d.nextSibling.firstChild,E=g.nextSibling,D=s.nextSibling,O=D.firstChild,j=O.firstChild,N=j.firstChild,P=D.nextSibling,F=P.nextSibling.firstChild,I=F.nextSibling,L=I.firstChild.nextSibling.nextSibling;L.nextSibling,e.$$click=he,r.$$click=J,o(d,()=>M().length,f),o(d,l,h),g.$$click=se,E.$$click=ce,o(t,_(a,{get when(){return p(()=>T().length>0)()&&M().length===0},get children(){var e=te(),t=e.firstChild,n=t.firstChild.nextSibling.nextSibling;return n.nextSibling,t.$$click=le,o(t,()=>T().length,n),e}}),D),o(t,_(a,{get when(){return $().length>0},get children(){var e=y(),t=e.firstChild.nextSibling;return o(t,_(u,{get each(){return $()},children:e=>(()=>{var t=x(),n=t.firstChild,r=n.nextSibling;return o(t,()=>W(e.provider||e.providerType||`未知`),n),o(t,()=>e.name||e.id,r),r.$$click=()=>q(e),t})()})),e}}),D),o(D,_(a,{get when(){return ae()},get children(){var e=ne();return e.$$click=()=>Z(`left`),e}}),O),O.addEventListener(`mouseleave`,me),O.$$mouseup=pe,O.$$mousemove=fe,O.$$mousedown=X,O.addEventListener(`wheel`,de),O.addEventListener(`scroll`,Y);var R=H;return typeof R==`function`?ee(R,O):H=O,N.$$click=()=>w(`all`),o(j,_(u,{get each(){return G().providers},children:e=>(()=>{var t=S();return t.$$click=()=>w(e.id),o(t,()=>e.displayName),i(()=>m(t,`solid-multi-tab ${v()===e.id?`active`:``}`)),t})()}),null),o(D,_(a,{get when(){return oe()},get children(){var e=re();return e.$$click=()=>Z(`right`),e}}),null),o(P,_(a,{get when(){return c.availableModels.length>0},get fallback(){return C()},get children(){var e=ie();return o(e,_(u,{get each(){return K()},children:e=>{let t=A(e),n=()=>M().includes(t),r=()=>!n()&&M().length>=l();return _(k,{model:e,get isSelected(){return n()},get isDisabled(){return r()},onToggle:()=>!r()&&q(e),get providerDisplayName(){return W(e.provider||e.providerType||`未知`)},get isDark(){return c.themeMode===`dark`}})}})),e}})),F.$$click=J,I.$$click=ue,o(I,()=>M().length,L),i(n=>{var r=`solid-multi-dialog-backdrop ${c.themeMode}`,i=`solid-multi-dialog ${c.fullScreen?`fullscreen`:``} ${c.themeMode}`,a=c.availableModels.length===0,o=M().length===0,s=`solid-multi-tab ${v()===`all`?`active`:``}`,l=M().length===0;return r!==n.e&&m(e,n.e=r),i!==n.t&&m(t,n.t=i),a!==n.a&&(g.disabled=n.a=a),o!==n.o&&(E.disabled=n.o=o),s!==n.i&&m(N,n.i=s),l!==n.n&&(I.disabled=n.n=l),n},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),e}})}})}function k(e){let t=g(()=>v(e.model.id||``,e.model.provider||e.model.providerType||``,e.isDark));return(()=>{var n=w(),r=n.firstChild,a=r.firstChild,s=r.nextSibling,l=s.firstChild,u=l.nextSibling,d=s.nextSibling.firstChild,p=d.nextSibling;return f(n,`click`,e.onToggle,!0),f(a,`change`,e.onToggle),l.addEventListener(`error`,e=>{e.currentTarget.style.display=`none`;let t=e.currentTarget.nextElementSibling;t&&(t.style.display=`flex`)}),o(u,()=>e.providerDisplayName[0]),o(d,()=>e.model.name||e.model.id),o(p,()=>e.model.description||e.model.id),i(r=>{var i=`solid-multi-model-item ${e.isSelected?`selected`:``} ${e.isDisabled?`disabled`:``}`,o=e.isDisabled,s=t(),u=e.providerDisplayName,f=`solid-multi-model-name ${e.isSelected?`selected`:``}`;return i!==r.e&&m(n,r.e=i),o!==r.t&&(a.disabled=r.t=o),s!==r.a&&c(l,`src`,r.a=s),u!==r.o&&c(l,`alt`,r.o=u),f!==r.i&&m(d,r.i=f),r},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),i(()=>a.checked=e.isSelected),n})()}var A=O;d([`click`,`mousedown`,`mousemove`,`mouseup`]);export{O as MultiModelSelector,A as default};