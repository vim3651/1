import{Ud as e,fd as t,qp as n,xd as r,xp as i,zp as a}from"./index-hvLbsAjx.js";var o=n(a(),1),s=n(i(),1),c=({ref:n,...i})=>{let{items:a,command:c}=i,[l,u]=(0,o.useState)(0),d=(0,o.useRef)(null),f=(0,o.useRef)(!0),p=e();(0,o.useEffect)(()=>{f.current=!0,u(0)},[a]),(0,o.useEffect)(()=>{if(d.current&&a.length>0&&f.current){let e=d.current.querySelector(`[data-index="${l}"]`);e&&e.scrollIntoView({block:`nearest`,behavior:`smooth`})}},[l,a.length]);let m=(0,o.useCallback)(e=>{let t=i.items[e];t&&c({id:t.id,label:t.title})},[i.items,c]),h=(0,o.useCallback)(e=>{if(!a.length)return!1;switch(e.key){case`ArrowUp`:return e.preventDefault(),f.current=!0,u(e=>e===0?a.length-1:e-1),!0;case`ArrowDown`:return e.preventDefault(),f.current=!0,u(e=>e===a.length-1?0:e+1),!0;case`Enter`:return e.shiftKey?!1:(e.preventDefault(),a[l]&&m(l),!0);case`Escape`:return e.preventDefault(),!0;default:return!1}},[a,l,m]);(0,o.useImperativeHandle)(n,()=>({...i,updateSelectedIndex:e=>{f.current=!0,u(e)},selectCurrent:()=>m(l),onKeyDown:h}),[h,i,l,m]);let g=(0,o.useMemo)(()=>{let e=p.palette.mode===`dark`;return{background:e?p.palette.background.paper:`#ffffff`,border:e?p.palette.divider:`#e1e5e9`,selectedBackground:e?p.palette.action.hover:`#f0f0f0`,boxShadow:e?`0 4px 12px rgba(0, 0, 0, 0.3)`:`0 4px 12px rgba(0, 0, 0, 0.1)`}},[p]),_=(0,o.useCallback)(e=>{f.current=!1,u(e)},[]);return(0,s.jsx)(t,{ref:d,className:`command-list-popover`,sx:{background:g.background,border:`1px solid ${g.border}`,borderRadius:`8px`,boxShadow:g.boxShadow,maxHeight:`280px`,overflow:`auto`,display:`flex`,flexDirection:`column`,minWidth:`240px`,maxWidth:`320px`},children:a.length===0?(0,s.jsx)(t,{sx:{padding:`12px`,color:`text.secondary`,textAlign:`center`,fontSize:`14px`},children:`未找到命令`}):a.map((e,n)=>(0,s.jsx)(t,{"data-index":n,onClick:()=>m(n),onMouseEnter:()=>_(n),sx:{padding:`10px 16px`,cursor:`pointer`,backgroundColor:n===l?g.selectedBackground:`transparent`,border:`none`,borderRadius:`4px`,margin:`2px`,minHeight:`46px`,display:`flex`,alignItems:`center`,transition:`background-color 0.15s ease`,"&:hover":{backgroundColor:g.selectedBackground}},children:(0,s.jsxs)(t,{sx:{display:`flex`,alignItems:`center`,gap:`12px`,width:`100%`},children:[(0,s.jsx)(t,{sx:{width:`20px`,height:`20px`,flexShrink:0,display:`flex`,alignItems:`center`,justifyContent:`center`,color:`text.secondary`},children:(0,s.jsx)(e.icon,{size:16})}),(0,s.jsxs)(t,{sx:{flex:1,minWidth:0},children:[(0,s.jsx)(r,{variant:`body2`,sx:{fontWeight:600,fontSize:`14px`,lineHeight:`20px`,color:`text.primary`},children:e.title}),(0,s.jsx)(r,{variant:`caption`,sx:{fontSize:`12px`,lineHeight:`16px`,color:`text.secondary`},children:e.description})]})]})},e.id))})};c.displayName=`CommandListPopover`;var l=c;export{l as default};