import{Ef as e,at as t}from"./index-hvLbsAjx.js";const n=`NOTE_STORAGE_PATH`,r=`ENABLE_NOTE_SIDEBAR`,i=class i{static instance;constructor(){}static getInstance(){return i.instance||=new i,i.instance}async getStoragePath(){return await e.getSetting(n)}async setStoragePath(t){await e.saveSetting(n,t)}async isSidebarEnabled(){return await e.getSetting(r)===!0}async setSidebarEnabled(t){await e.saveSetting(r,t)}async getFullPath(e=``){let t=await this.getStoragePath();if(!t)throw Error(`未设置笔记存储目录`);let n=t.endsWith(`/`)?t.slice(0,-1):t,r=e.startsWith(`/`)?e.slice(1):e;return r?`${n}/${r}`:n}async listNotes(e=``){let n=await this.getFullPath(e);try{return(await t.listDirectory({path:n,showHidden:!1,sortBy:`name`,sortOrder:`asc`})).files.map(t=>({id:e?`${e}/${t.name}`:t.name,name:t.name,path:e?`${e}/${t.name}`:t.name,isDirectory:t.type===`directory`,lastModified:new Date(t.mtime||Date.now()).toISOString(),size:t.size,extension:t.name.split(`.`).pop()})).sort((e,t)=>e.isDirectory&&!t.isDirectory?-1:!e.isDirectory&&t.isDirectory?1:e.name.localeCompare(t.name))}catch(e){throw console.error(`获取笔记列表失败:`,e),e}}async createNote(e,n,r=``){let i=await this.getFullPath(e),a=n.endsWith(`.md`)?n:`${n}.md`;await t.createTextFile(i,a,r)}async createFolder(e,n){let r=`${await this.getFullPath(e)}/${n}`;await t.createDirectory({path:r,recursive:!1})}async readNote(e){let n=await this.getFullPath(e);return(await t.readFile({path:n,encoding:`utf8`})).content}async saveNote(e,n){let r=await this.getFullPath(e);await t.writeFile({path:r,content:n,encoding:`utf8`,append:!1})}async deleteItem(e,n){let r=await this.getFullPath(e);n?await t.deleteDirectory({path:r}):await t.deleteFile({path:r})}async renameItem(e,n){let r=await this.getFullPath(e);await t.renameFile({path:r,newName:n})}async hasValidConfig(){return!!await this.getStoragePath()}}.getInstance();export{n,i as r,r as t};