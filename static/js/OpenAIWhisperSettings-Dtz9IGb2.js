import{n as e,r as t}from"./VoiceRecognition-BD7QZRqp.js";import{Ad as n,Cd as r,Du as i,Sd as a,_ as o,bd as s,ci as c,dd as l,fd as u,ip as d,np as f,pp as p,qd as m,qp as h,xd as g,xp as _,xu as v,zp as y}from"./index-hvLbsAjx.js";import"./useVoiceRecognition-BsXW9Pyd.js";var b=h(y(),1),x=h(_(),1),S=()=>{let h=p(),{t:_}=c(),[y,S]=(0,b.useState)({apiKey:``,showApiKey:!1,model:`whisper-1`,language:`zh`,temperature:0,responseFormat:`json`}),[C,w]=(0,b.useState)({enabled:!0,language:`zh-CN`,autoStart:!1,silenceTimeout:2e3,maxResults:5,partialResults:!0,permissionStatus:`unknown`,provider:`openai`}),[T,E]=(0,b.useState)({saveError:``});(0,b.useEffect)(()=>{(async()=>{try{let e=await f(`whisper_api_key`)||``,t=await f(`whisper_model`)||`whisper-1`,n=await f(`whisper_language`)||`zh`,r=Number(await f(`whisper_temperature`)||`0`),i=await f(`whisper_response_format`)||`json`,a=await f(`speech_recognition_enabled`)!==`false`,o=await f(`speech_recognition_language`)||`zh-CN`,s=await f(`speech_recognition_auto_start`)===`true`,c=Number(await f(`speech_recognition_silence_timeout`)||`2000`),l=Number(await f(`speech_recognition_max_results`)||`5`),u=await f(`speech_recognition_partial_results`)!==`false`;S({apiKey:e,showApiKey:!1,model:t,language:n,temperature:r,responseFormat:i}),w({enabled:a,language:o,autoStart:s,silenceTimeout:c,maxResults:l,partialResults:u,permissionStatus:`unknown`,provider:`openai`})}catch(e){console.error(_(`settings.voice.common.loadingError`,{service:`OpenAI Whisper`}),e)}})()},[_]);let D=(0,b.useCallback)(async()=>{try{await d(`whisper_api_key`,y.apiKey),await d(`whisper_model`,y.model),await d(`whisper_language`,y.language||``),await d(`whisper_temperature`,y.temperature?.toString()||`0`),await d(`whisper_response_format`,y.responseFormat||`json`),await d(`speech_recognition_enabled`,C.enabled.toString()),await d(`speech_recognition_language`,C.language),await d(`speech_recognition_auto_start`,C.autoStart.toString()),await d(`speech_recognition_silence_timeout`,C.silenceTimeout.toString()),await d(`speech_recognition_max_results`,C.maxResults.toString()),await d(`speech_recognition_partial_results`,C.partialResults.toString()),await d(`speech_recognition_provider`,`openai`),setTimeout(()=>{h(`/settings/voice`)},0)}catch(e){console.error(_(`settings.voice.common.saveErrorText`,{service:`OpenAI Whisper`}),e),E(e=>({...e,saveError:_(`settings.voice.common.saveError`)}))}},[y,C,h,_]),O=()=>{h(`/settings/voice`)};return(0,x.jsxs)(o,{sx:{width:`100vw`,overflow:`hidden`,bgcolor:`background.default`},children:[(0,x.jsx)(s,{position:`static`,elevation:0,sx:{bgcolor:`background.paper`,color:`text.primary`,borderBottom:1,borderColor:`divider`,backdropFilter:`blur(20px)`,WebkitBackdropFilter:`blur(20px)`,background:`rgba(255, 255, 255, 0.8)`,"@media (prefers-color-scheme: dark)":{background:`rgba(18, 18, 18, 0.8)`}},children:(0,x.jsxs)(i,{sx:{minHeight:{xs:56,sm:64},px:{xs:1,sm:2,md:3}},children:[(0,x.jsx)(r,{edge:`start`,onClick:O,"aria-label":_(`settings.voice.back`),size:`large`,sx:{color:`primary.main`,mr:{xs:1,sm:2},"&:hover":{bgcolor:`primary.main`,color:`primary.contrastText`,transform:`scale(1.05)`},transition:`all 0.2s ease-in-out`},children:(0,x.jsx)(v,{size:20})}),(0,x.jsx)(g,{variant:`h6`,component:`div`,sx:{flexGrow:1,fontWeight:600},children:_(`settings.voice.whisper.title`)}),(0,x.jsx)(l,{onClick:D,variant:`contained`,sx:{bgcolor:`primary.main`,color:`primary.contrastText`,"&:hover":{bgcolor:`primary.dark`},borderRadius:2,px:3},children:_(`settings.voice.common.save`)})]})}),(0,x.jsx)(u,{sx:{flexGrow:1,overflowY:`auto`,p:2,bgcolor:e=>e.palette.mode===`light`?m(e.palette.primary.main,.02):m(e.palette.background.default,.9),"&::-webkit-scrollbar":{width:`6px`},"&::-webkit-scrollbar-thumb":{backgroundColor:`rgba(0,0,0,0.1)`,borderRadius:`3px`}},children:(0,x.jsxs)(u,{sx:{width:`100%`},children:[T.saveError&&(0,x.jsx)(a,{severity:`error`,sx:{mb:{xs:1.5,sm:2},borderRadius:{xs:1,sm:2}},children:T.saveError}),(0,x.jsx)(n,{elevation:0,sx:{p:3,mb:3,borderRadius:2,border:`1px solid`,borderColor:`divider`,background:`background.paper`,boxShadow:`0 4px 12px rgba(0,0,0,0.05)`},children:(0,x.jsx)(t,{settings:y,onSettingsChange:S})}),(0,x.jsx)(n,{elevation:0,sx:{p:3,mb:3,borderRadius:2,border:`1px solid`,borderColor:`divider`,background:`background.paper`,boxShadow:`0 4px 12px rgba(0,0,0,0.05)`},children:(0,x.jsx)(e,{settings:y,enabled:C.enabled})})]})})]})};export{S as default};