const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["static/js/DexieStorageService-DL7TDV0g.js","static/js/index-hvLbsAjx.js","static/css/index-iKlUzaLt.css"])))=>i.map(i=>d[i]);
import{t as e}from"./Switch-C_ekiChs.js";import{t}from"./pen-line-BjK4aRQz.js";import{t as n}from"./plus-DCrdXXDc.js";import{t as r}from"./search-DqeTnaF8.js";import{$t as i,A as a,Ad as o,Al as s,Bl as c,Cd as l,Cu as u,Du as d,Eu as f,Gi as p,Hd as m,Iu as h,Jt as g,Nu as ee,Ol as _,Qt as v,Qu as y,Rl as b,Sd as te,Su as x,Ud as ne,Vl as re,_ as ie,an as ae,bd as S,bp as oe,dd as C,du as w,en as T,f as se,fd as E,in as D,jp as ce,ku as le,m as ue,nn as de,o as O,on as k,pp as fe,qp as A,qt as pe,rn as me,tn as he,vd as j,wd as ge,xd as M,xp as N,xu as P,yu as F,zp as I}from"./index-hvLbsAjx.js";import{t as L}from"./SolidBridge-4JuNrAWl.js";import{t as _e}from"./settingsSelectors-BdPnPOZr.js";import{t as R}from"./DialogModelSelector.solid-B0UTW3Od.js";var ve=x(`users`,[[`path`,{d:`M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2`,key:`1yyitq`}],[`path`,{d:`M16 3.128a4 4 0 0 1 0 7.744`,key:`16gr8j`}],[`path`,{d:`M22 21v-2a4 4 0 0 0-3-3.87`,key:`kshegd`}],[`circle`,{cx:`9`,cy:`7`,r:`4`,key:`nufk8`}]]),z=A(I(),1),B=A(N(),1),ye=({open:e,onClose:t,memoryText:n,onMemoryTextChange:r,onAdd:i})=>(0,B.jsx)(p,{open:e,onClose:t,maxWidth:`sm`,fullWidth:!0,children:(0,B.jsxs)(E,{sx:{p:2},children:[(0,B.jsx)(M,{variant:`h6`,sx:{mb:2},children:`添加记忆`}),(0,B.jsx)(f,{fullWidth:!0,multiline:!0,rows:3,placeholder:`输入要记住的内容...`,value:n,onChange:e=>r(e.target.value),sx:{mb:2}}),(0,B.jsxs)(E,{sx:{display:`flex`,justifyContent:`flex-end`,gap:1},children:[(0,B.jsx)(C,{onClick:t,children:`取消`}),(0,B.jsx)(C,{variant:`contained`,onClick:i,children:`添加`})]})]})}),be=({open:e,onClose:t,memoryText:n,onMemoryTextChange:r,onSave:i})=>(0,B.jsx)(p,{open:e,onClose:t,maxWidth:`sm`,fullWidth:!0,children:(0,B.jsxs)(E,{sx:{p:2},children:[(0,B.jsx)(M,{variant:`h6`,sx:{mb:2},children:`编辑记忆`}),(0,B.jsx)(f,{fullWidth:!0,multiline:!0,rows:3,value:n,onChange:e=>r(e.target.value),sx:{mb:2}}),(0,B.jsxs)(E,{sx:{display:`flex`,justifyContent:`flex-end`,gap:1},children:[(0,B.jsx)(C,{onClick:t,children:`取消`}),(0,B.jsx)(C,{variant:`contained`,onClick:i,children:`保存`})]})]})}),xe=({open:e,onClose:t,selectedLLMModel:n,llmMenuOpen:r,onLlmMenuOpen:i,onLlmMenuClose:a,onLlmModelSelect:o,selectedEmbeddingModel:s,embeddingMenuOpen:c,onEmbeddingMenuOpen:u,onEmbeddingMenuClose:d,onEmbeddingModelSelect:m,embeddingDimensions:h,onEmbeddingDimensionsChange:g,onDetectDimensions:ee,models:_,providers:v,themeMode:y,fullScreen:b,onSave:te})=>(0,B.jsx)(p,{open:e,onClose:t,maxWidth:`sm`,fullWidth:!0,children:(0,B.jsxs)(E,{sx:{p:2},children:[(0,B.jsxs)(E,{sx:{display:`flex`,justifyContent:`space-between`,alignItems:`center`,mb:3},children:[(0,B.jsx)(M,{variant:`h6`,children:`记忆设置`}),(0,B.jsx)(l,{onClick:t,size:`small`,children:`×`})]}),(0,B.jsxs)(E,{sx:{mb:2},children:[(0,B.jsx)(M,{variant:`body2`,color:`error`,sx:{mb:.5},children:`* LLM 模型`}),(0,B.jsx)(E,{onClick:i,sx:{p:1.5,border:`1px solid`,borderColor:`divider`,borderRadius:1,cursor:`pointer`,display:`flex`,alignItems:`center`,gap:1,"&:hover":{borderColor:`primary.main`}},children:(0,B.jsx)(M,{variant:`body2`,color:n?`text.primary`:`text.secondary`,children:n?n.name||n.id:`未选择模型`})}),(0,B.jsx)(L,{component:R,props:{selectedModel:n,availableModels:_,handleModelSelect:e=>{o(e)},handleMenuClose:a,menuOpen:r,providers:v,themeMode:y,fullScreen:b},debugName:`LLMModelSelector`})]}),(0,B.jsxs)(E,{sx:{mb:2},children:[(0,B.jsx)(M,{variant:`body2`,color:`error`,sx:{mb:.5},children:`* 嵌入模型`}),(0,B.jsx)(E,{onClick:u,sx:{p:1.5,border:`1px solid`,borderColor:`divider`,borderRadius:1,cursor:`pointer`,display:`flex`,alignItems:`center`,gap:1,"&:hover":{borderColor:`primary.main`}},children:(0,B.jsx)(M,{variant:`body2`,color:s?`text.primary`:`text.secondary`,children:s?s.name||s.id:`未选择模型`})}),(0,B.jsx)(L,{component:R,props:{selectedModel:s,availableModels:_,handleModelSelect:e=>{m(e)},handleMenuClose:d,menuOpen:c,providers:v,themeMode:y,fullScreen:b},debugName:`EmbeddingModelSelector`})]}),(0,B.jsxs)(E,{sx:{mb:3},children:[(0,B.jsxs)(E,{sx:{display:`flex`,alignItems:`center`,gap:.5,mb:.5},children:[(0,B.jsx)(M,{variant:`body2`,children:`嵌入维度`}),(0,B.jsx)(le,{title:`向量嵌入的维度数，常见值：768, 1536, 3072`,children:(0,B.jsx)(w,{size:14,style:{opacity:.5}})})]}),(0,B.jsxs)(E,{sx:{display:`flex`,gap:1},children:[(0,B.jsx)(f,{type:`number`,value:h,onChange:e=>g(parseInt(e.target.value)||1536),size:`small`,fullWidth:!0,inputProps:{min:64,max:8192}}),(0,B.jsx)(l,{onClick:ee,size:`small`,children:(0,B.jsx)(re,{size:18})})]})]}),(0,B.jsxs)(E,{sx:{display:`flex`,justifyContent:`flex-end`,gap:1},children:[(0,B.jsx)(C,{onClick:t,children:`取消`}),(0,B.jsx)(C,{variant:`contained`,onClick:te,disabled:!n||!s,children:`确定`})]})]})}),Se=({open:e,onClose:t,currentPrompt:n,onSave:r})=>{let[i,o]=(0,z.useState)(``);(0,z.useEffect)(()=>{e&&o(n||a)},[e,n]);let s=()=>{o(a)},u=()=>{r(i),t()};return(0,B.jsxs)(p,{open:e,onClose:t,fullScreen:!0,sx:{"& .MuiDialog-paper":{backgroundColor:`background.default`}},children:[(0,B.jsx)(S,{position:`sticky`,elevation:0,sx:{backgroundColor:`background.paper`,borderBottom:`1px solid`,borderColor:`divider`,paddingTop:`env(safe-area-inset-top)`},children:(0,B.jsxs)(d,{children:[(0,B.jsx)(l,{edge:`start`,onClick:t,sx:{mr:1},children:(0,B.jsx)(P,{size:24})}),(0,B.jsx)(M,{variant:`h6`,sx:{flexGrow:1,color:`text.primary`},children:`自定义提示词`}),(0,B.jsx)(l,{onClick:s,title:`恢复默认`,children:(0,B.jsx)(c,{size:20})}),(0,B.jsx)(C,{variant:`contained`,size:`small`,onClick:u,sx:{ml:1},children:`保存`})]})}),(0,B.jsxs)(E,{sx:{flex:1,display:`flex`,flexDirection:`column`,p:2,paddingBottom:`calc(env(safe-area-inset-bottom) + 16px)`,overflow:`hidden`},children:[(0,B.jsx)(M,{variant:`body2`,color:`text.secondary`,sx:{mb:2},children:`此提示词用于自动分析模式，LLM 会根据此提示词从对话中提取用户相关的事实和偏好。`}),(0,B.jsx)(f,{fullWidth:!0,multiline:!0,value:i,onChange:e=>o(e.target.value),sx:{flex:1,"& .MuiInputBase-root":{height:`100%`,alignItems:`flex-start`},"& .MuiInputBase-input":{fontFamily:`monospace`,fontSize:`0.85rem`,height:`100% !important`,overflow:`auto !important`}}})]})]})},V=m(o)(({theme:e})=>({padding:e.spacing(2),marginBottom:e.spacing(2),borderRadius:Number(e.shape.borderRadius)*2})),H=m(M)(({theme:e})=>({fontWeight:600,marginBottom:e.spacing(1.5),display:`flex`,alignItems:`center`,gap:e.spacing(1)})),Ce=m(o)(({theme:e})=>({padding:e.spacing(1.5),marginBottom:e.spacing(1),borderRadius:e.shape.borderRadius,backgroundColor:e.palette.mode===`dark`?`rgba(255,255,255,0.05)`:`rgba(0,0,0,0.02)`})),we=m(E)(({theme:e})=>({display:`flex`,alignItems:`center`,gap:e.spacing(1),padding:e.spacing(1.5),borderRadius:e.shape.borderRadius,backgroundColor:e.palette.primary.main+`15`})),U=()=>{let a=fe(),o=v(),c=i(me),d=i(he),p=i(de),[m,x]=(0,z.useState)([]),[S,w]=(0,z.useState)([]),[le,A]=(0,z.useState)(!1),[N,P]=(0,z.useState)(``),[I,L]=(0,z.useState)(null),[R,U]=(0,z.useState)(``),[Te,W]=(0,z.useState)(!1),[Ee,G]=(0,z.useState)(!1),[De,K]=(0,z.useState)(!1),[Oe,ke]=(0,z.useState)({total:0,assistants:0}),[Ae,q]=(0,z.useState)(!1),[je,Me]=(0,z.useState)(!1),[Ne,Pe]=(0,z.useState)(c.llmModel||null),[J,Fe]=(0,z.useState)(c.embeddingModel||null),[Ie,Y]=(0,z.useState)(c.embeddingDimensions||1536),X=oe(_e),Le=ne(),Re=u(Le.breakpoints.down(`sm`)),ze=Le.palette.mode,[Be,Z]=(0,z.useState)(!1),[Ve,Q]=(0,z.useState)(!1),He=z.useMemo(()=>{let e=[];return X&&X.forEach(t=>{t.isEnabled&&t.models&&t.models.forEach(n=>{n.enabled&&e.push({...n,apiKey:n.apiKey||t.apiKey,baseUrl:n.baseUrl||t.baseUrl,providerType:n.providerType||t.providerType||t.id})})}),e},[X]),$=(0,z.useCallback)(async()=>{K(!0);try{let e=await k.list({assistantId:d,limit:100});x(e.memories),ke(t=>({...t,total:e.count}))}catch(e){console.error(`[MemorySettings] 加载记忆失败:`,e),O.error(`加载记忆失败`)}finally{K(!1)}},[d]),Ue=(0,z.useCallback)(async()=>{try{let{dexieStorage:e}=await ce(async()=>{let{dexieStorage:e}=await import(`./DexieStorageService-DL7TDV0g.js`);return{dexieStorage:e}},__vite__mapDeps([0,1,2])),t=(await e.getAllAssistants()).map(e=>({id:e.id,name:e.name,memoryEnabled:e.memoryEnabled})),n=t.length>0?t:[{id:`default`,name:`默认助手`,memoryEnabled:!1}];if(w(n),ke(e=>({...e,assistants:n.length})),n.length>0&&n[0].id!==`default`){let t=(await e.memories.toArray()).filter(e=>e.userId===`default-user`&&!e.isDeleted);if(t.length>0){console.log(`[MemorySettings] 迁移 ${t.length} 条旧记忆到助手 ${n[0].id}`);for(let r of t)await e.memories.update(r.id,{userId:n[0].id})}}!d||!n.find(e=>e.id===d)?(o(D(n[0].id)),A(n[0].memoryEnabled||!1)):A(n.find(e=>e.id===d)?.memoryEnabled||!1)}catch(e){console.error(`[MemorySettings] 加载助手列表失败:`,e)}},[d,o]);(0,z.useEffect)(()=>{$(),Ue()},[$,Ue]);let We=async()=>{if(!N.trim()){$();return}K(!0);try{x((await k.textSearch(N,{assistantId:d})).memories)}catch(e){console.error(`[MemorySettings] 搜索失败:`,e)}finally{K(!1)}},Ge=async()=>{if(R.trim())try{await k.add(R,{assistantId:d,metadata:{source:`manual`}})&&(O.success(`记忆已添加`),U(``),W(!1),$())}catch(e){console.error(`[MemorySettings] 添加记忆失败:`,e),O.error(`添加记忆失败`)}},Ke=async()=>{if(!(!I||!R.trim()))try{await k.update(I.id,R)&&(O.success(`记忆已更新`),L(null),U(``),G(!1),$())}catch(e){console.error(`[MemorySettings] 更新记忆失败:`,e),O.error(`更新记忆失败`)}},qe=async e=>{try{await k.delete(e)&&(O.success(`记忆已删除`),$())}catch(e){console.error(`[MemorySettings] 删除记忆失败:`,e),O.error(`删除记忆失败`)}},Je=async()=>{try{await k.deleteAllMemoriesForAssistant(d),O.success(`已清空所有记忆`),$()}catch(e){console.error(`[MemorySettings] 清空记忆失败:`,e),O.error(`清空记忆失败`)}},Ye=e=>{o(D(e)),A(S.find(t=>t.id===e)?.memoryEnabled||!1)},Xe=async e=>{if(!(!d||d===`default`))try{let{dexieStorage:t}=await ce(async()=>{let{dexieStorage:e}=await import(`./DexieStorageService-DL7TDV0g.js`);return{dexieStorage:e}},__vite__mapDeps([0,1,2])),n=await t.getAssistant(d);if(n){let r={...n,memoryEnabled:e};await t.saveAssistant(r),A(e),w(t=>t.map(t=>t.id===d?{...t,memoryEnabled:e}:t)),O.success(e?`已开启助手记忆功能`:`已关闭助手记忆功能`)}}catch(e){console.error(`[MemorySettings] 切换助手记忆失败:`,e),O.error(`切换助手记忆失败`)}},Ze=e=>{e&&!c.llmModel&&q(!0),o(ae(e))};return(0,B.jsxs)(ie,{children:[(0,B.jsx)(ue,{title:`记忆设置`,onBackPress:()=>{a(`/settings`)}}),(0,B.jsxs)(se,{sx:{overflow:`auto`,pb:4},children:[(0,B.jsx)(V,{elevation:0,children:(0,B.jsxs)(E,{sx:{display:`flex`,justifyContent:`space-between`,alignItems:`center`},children:[(0,B.jsxs)(E,{children:[(0,B.jsxs)(H,{variant:`subtitle1`,children:[(0,B.jsx)(F,{size:20}),`启用记忆功能`]}),(0,B.jsx)(M,{variant:`body2`,color:`text.secondary`,children:`开启后，AI 将自动记住对话中的重要信息`})]}),(0,B.jsx)(e,{checked:p,onChange:e=>Ze(e.target.checked),color:`primary`})]})}),p&&!c.llmModel&&(0,B.jsx)(te,{severity:`warning`,sx:{mb:2},icon:(0,B.jsx)(_,{size:20}),action:(0,B.jsx)(C,{color:`inherit`,size:`small`,onClick:()=>q(!0),children:`配置`}),children:`记忆功能需要配置 LLM 模型和嵌入模型才能正常工作。`}),(0,B.jsx)(V,{elevation:0,children:(0,B.jsxs)(E,{sx:{display:`flex`,justifyContent:`space-between`,alignItems:`center`},children:[(0,B.jsxs)(E,{children:[(0,B.jsxs)(H,{variant:`subtitle1`,children:[(0,B.jsx)(b,{size:20}),`模型配置`]}),(0,B.jsxs)(M,{variant:`body2`,color:`text.secondary`,children:[c.llmModel?`LLM: ${c.llmModel.name||c.llmModel.id}`:`LLM: 未配置`,` | `,c.embeddingModel?`嵌入: ${c.embeddingModel.name||c.embeddingModel.id}`:`嵌入: 未配置`]})]}),(0,B.jsx)(C,{variant:`outlined`,size:`small`,onClick:()=>q(!0),children:`配置`})]})}),p&&(0,B.jsxs)(V,{elevation:0,children:[(0,B.jsxs)(H,{variant:`subtitle1`,children:[(0,B.jsx)(F,{size:20}),`记忆方式`]}),(0,B.jsxs)(E,{sx:{display:`flex`,alignItems:`center`,justifyContent:`space-between`,p:1.5,mb:1,borderRadius:1,backgroundColor:e=>e.palette.mode===`dark`?`rgba(255,255,255,0.05)`:`rgba(0,0,0,0.02)`},children:[(0,B.jsxs)(E,{children:[(0,B.jsx)(M,{variant:`body2`,fontWeight:`medium`,children:`记忆工具（推荐）`}),(0,B.jsx)(M,{variant:`caption`,color:`text.secondary`,children:`AI 自主判断何时记忆，通过工具调用保存，节省成本`})]}),(0,B.jsx)(e,{checked:c.memoryToolEnabled||!1,onChange:e=>o(T({memoryToolEnabled:e.target.checked})),color:`primary`})]}),(0,B.jsxs)(E,{sx:{display:`flex`,alignItems:`center`,justifyContent:`space-between`,p:1.5,borderRadius:1,backgroundColor:e=>e.palette.mode===`dark`?`rgba(255,255,255,0.05)`:`rgba(0,0,0,0.02)`},children:[(0,B.jsxs)(E,{children:[(0,B.jsx)(M,{variant:`body2`,fontWeight:`medium`,children:`自动分析`}),(0,B.jsx)(M,{variant:`caption`,color:`text.secondary`,children:`每次对话后 LLM 自动分析提取事实，会增加 API 成本`})]}),(0,B.jsx)(e,{checked:c.autoAnalyzeEnabled||!1,onChange:e=>o(T({autoAnalyzeEnabled:e.target.checked})),color:`primary`})]}),c.autoAnalyzeEnabled&&(0,B.jsx)(E,{sx:{mt:1,display:`flex`,justifyContent:`flex-end`},children:(0,B.jsx)(C,{size:`small`,variant:`text`,onClick:()=>Me(!0),children:`自定义提示词`})})]}),(0,B.jsxs)(V,{elevation:0,children:[(0,B.jsxs)(H,{variant:`subtitle1`,children:[(0,B.jsx)(b,{size:20}),`统计信息`]}),(0,B.jsxs)(E,{sx:{display:`flex`,gap:2,flexWrap:`wrap`},children:[(0,B.jsxs)(we,{children:[(0,B.jsx)(F,{size:18}),(0,B.jsxs)(M,{variant:`body2`,children:[(0,B.jsx)(`strong`,{children:Oe.total}),` 条记忆`]})]}),(0,B.jsxs)(we,{children:[(0,B.jsx)(ve,{size:18}),(0,B.jsxs)(M,{variant:`body2`,children:[(0,B.jsx)(`strong`,{children:Oe.assistants}),` 个助手`]})]})]})]}),(0,B.jsxs)(V,{elevation:0,children:[(0,B.jsxs)(H,{variant:`subtitle1`,children:[(0,B.jsx)(ve,{size:20}),`当前助手`]}),(0,B.jsx)(y,{fullWidth:!0,size:`small`,children:(0,B.jsx)(ee,{value:S.length>0&&d||``,onChange:e=>Ye(e.target.value),displayEmpty:!0,children:S.length===0?(0,B.jsx)(h,{value:``,children:`加载中...`}):S.map(e=>(0,B.jsx)(h,{value:e.id,children:e.name},e.id))})}),d&&d!==`default`&&(0,B.jsxs)(E,{sx:{display:`flex`,alignItems:`center`,justifyContent:`space-between`,mt:2,p:1.5,borderRadius:1,backgroundColor:e=>e.palette.mode===`dark`?`rgba(255,255,255,0.05)`:`rgba(0,0,0,0.02)`},children:[(0,B.jsxs)(E,{sx:{display:`flex`,alignItems:`center`,gap:1},children:[(0,B.jsx)(F,{size:18}),(0,B.jsxs)(E,{children:[(0,B.jsx)(M,{variant:`body2`,children:`启用此助手的记忆功能`}),(0,B.jsx)(M,{variant:`caption`,color:`text.secondary`,children:`开启后，此助手会记住与你的对话内容`})]})]}),(0,B.jsx)(e,{checked:le,onChange:e=>Xe(e.target.checked),color:`primary`})]})]}),(0,B.jsxs)(V,{elevation:0,children:[(0,B.jsxs)(E,{sx:{display:`flex`,gap:1,mb:2},children:[(0,B.jsx)(f,{fullWidth:!0,size:`small`,placeholder:`搜索记忆...`,value:N,onChange:e=>P(e.target.value),onKeyPress:e=>e.key===`Enter`&&We(),InputProps:{startAdornment:(0,B.jsx)(r,{size:18,style:{marginRight:8,opacity:.5}})}}),(0,B.jsx)(l,{onClick:We,size:`small`,children:(0,B.jsx)(r,{size:18})}),(0,B.jsx)(l,{onClick:$,size:`small`,children:(0,B.jsx)(re,{size:18})})]}),(0,B.jsxs)(E,{sx:{display:`flex`,gap:1},children:[(0,B.jsx)(C,{variant:`contained`,size:`small`,startIcon:(0,B.jsx)(n,{size:16}),onClick:()=>{U(``),W(!0)},children:`添加记忆`}),(0,B.jsx)(C,{variant:`outlined`,size:`small`,color:`error`,startIcon:(0,B.jsx)(s,{size:16}),onClick:Je,children:`清空全部`})]})]}),(0,B.jsxs)(V,{elevation:0,children:[(0,B.jsxs)(H,{variant:`subtitle1`,children:[(0,B.jsx)(F,{size:20}),`记忆列表 (`,m.length,`)`]}),De?(0,B.jsx)(E,{sx:{display:`flex`,justifyContent:`center`,py:4},children:(0,B.jsx)(ge,{size:24})}):m.length===0?(0,B.jsx)(M,{variant:`body2`,color:`text.secondary`,sx:{textAlign:`center`,py:4},children:`暂无记忆`}):(0,B.jsx)(E,{children:m.map(e=>(0,B.jsx)(Ce,{elevation:0,children:(0,B.jsxs)(E,{sx:{display:`flex`,justifyContent:`space-between`,alignItems:`flex-start`},children:[(0,B.jsxs)(E,{sx:{flex:1,mr:1},children:[(0,B.jsx)(M,{variant:`body2`,children:e.memory}),(0,B.jsxs)(E,{sx:{display:`flex`,gap:.5,mt:1,flexWrap:`wrap`},children:[e.metadata?.source&&(0,B.jsx)(j,{label:e.metadata.source===`auto`?`自动`:`手动`,size:`small`,variant:`outlined`,sx:{height:20,fontSize:`0.7rem`}}),e.score&&(0,B.jsx)(j,{label:`相似度: ${(e.score*100).toFixed(0)}%`,size:`small`,color:`primary`,variant:`outlined`,sx:{height:20,fontSize:`0.7rem`}}),(0,B.jsx)(M,{variant:`caption`,color:`text.secondary`,children:new Date(e.createdAt).toLocaleDateString()})]})]}),(0,B.jsxs)(E,{sx:{display:`flex`,gap:.5},children:[(0,B.jsx)(l,{size:`small`,onClick:()=>{L(e),U(e.memory),G(!0)},children:(0,B.jsx)(t,{size:16})}),(0,B.jsx)(l,{size:`small`,color:`error`,onClick:()=>qe(e.id),children:(0,B.jsx)(s,{size:16})})]})]})},e.id))})]})]}),(0,B.jsx)(ye,{open:Te,onClose:()=>W(!1),memoryText:R,onMemoryTextChange:U,onAdd:Ge}),(0,B.jsx)(be,{open:Ee,onClose:()=>G(!1),memoryText:R,onMemoryTextChange:U,onSave:Ke}),(0,B.jsx)(xe,{open:Ae,onClose:()=>q(!1),selectedLLMModel:Ne,llmMenuOpen:Be,onLlmMenuOpen:()=>Z(!0),onLlmMenuClose:()=>Z(!1),onLlmModelSelect:e=>{Pe(e),Z(!1)},selectedEmbeddingModel:J,embeddingMenuOpen:Ve,onEmbeddingMenuOpen:()=>Q(!0),onEmbeddingMenuClose:()=>Q(!1),onEmbeddingModelSelect:e=>{Fe(e),Q(!1)},embeddingDimensions:Ie,onEmbeddingDimensionsChange:Y,onDetectDimensions:async()=>{if(!J){O.warning(`请先选择嵌入模型`);return}let e=J.id,t=g(e);if(t===1536){let t=e.toLowerCase(),n=pe.find(e=>t.includes(e.id.toLowerCase())||e.id.toLowerCase().includes(t));if(n){Y(n.dimensions),O.success(`已检测维度: ${n.dimensions}`);return}}Y(t),O.success(`已检测维度: ${t}`)},models:He,providers:X,themeMode:ze,fullScreen:Re,onSave:()=>{let e={llmModel:Ne||void 0,embeddingModel:J||void 0,embeddingDimensions:Ie};o(T(e)),k.setConfig(e),O.success(`配置已保存`),q(!1)}}),(0,B.jsx)(Se,{open:je,onClose:()=>Me(!1),currentPrompt:c.customFactExtractionPrompt,onSave:e=>{o(T({customFactExtractionPrompt:e})),O.success(`提示词已保存`)}})]})};export{U as default};