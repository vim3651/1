import{ei as e,qi as t}from"./index-hvLbsAjx.js";import{C as n,D as r,E as i,S as a,_ as o,a as s,b as c,c as l,f as u,g as d,i as f,n as p,o as m,p as h,r as g,t as _,x as v,y}from"./web-DV3rYUP8.js";import{t as b}from"./providerIcons-C3i_yWyD.js";var x=u(`<button class="solid-tab-scroll-button left"aria-label=向左滚动><svg width=24 height=24 viewBox="0 0 24 24"fill=none stroke=currentColor stroke-width=2><polyline points="15 18 9 12 15 6">`),S=u(`<button class=solid-tab>`),ee=u(`<button class="solid-tab-scroll-button right"aria-label=向右滚动><svg width=24 height=24 viewBox="0 0 24 24"fill=none stroke=currentColor stroke-width=2><polyline points="9 18 15 12 9 6">`),C=u(`<div><div><div class=solid-dialog-header><h2 class=solid-dialog-title>选择模型<span style=margin-left:8px;font-size:12px;color:#90caf9;font-weight:normal>⚡ SolidJS</span></h2><button class=solid-dialog-close-btn aria-label=close><svg width=24 height=24 viewBox="0 0 24 24"fill=none stroke=currentColor stroke-width=2><line x1=18 y1=6 x2=6 y2=18></line><line x1=6 y1=6 x2=18 y2=18></line></svg></button></div><div class=solid-tabs-wrapper><div class=solid-tabs-container><div class=solid-tabs><button class=solid-tab>全部</button></div></div></div><div class=solid-dialog-content><div class=solid-model-list>`),w=u(`<div class=solid-model-check><svg width=20 height=20 viewBox="0 0 24 24"fill=none stroke=currentColor stroke-width=2><polyline points="20 6 9 17 4 12">`),T=u(`<div class=solid-model-item><div class=solid-model-icon><img><div class=solid-model-icon-fallback style=display:none></div></div><div class=solid-model-info><div class=solid-model-name></div><div class=solid-model-description>`);function E(l){let[u,f]=n(`all`),[w,T]=n(!1),[E,O]=n(!1),[k,A]=n(!1),[j,M]=n(0),[N,te]=n(0),P,F,I=v(()=>{let e=new Map;return l.providers.forEach(t=>{e.set(t.id,t.name)}),e}),L=e=>I().get(e)||e,R=v(()=>{let t=l.themeMode===`dark`,n=new Map;return l.availableModels.forEach(r=>{let i=e({id:r.id,provider:r.provider});n.has(i)||n.set(i,b(r.id,r.provider||r.providerType||``,t))}),n}),z=t=>{let n=e({id:t.id,provider:t.provider});return R().get(n)||`/images/providerIcons/dark/custom.png`},B=v(()=>{let e={},t={};l.availableModels.forEach(n=>{let r=n.provider||n.providerType||`未知`,i=L(r);t[r]||(t[r]={id:r,displayName:i}),e[r]||(e[r]=[]),e[r].push(n)});let n=Object.values(t),r=new Map;return l.providers.forEach((e,t)=>{r.set(e.id,t)}),n.sort((e,t)=>{let n=r.get(e.id),i=r.get(t.id);return n!==void 0&&i!==void 0?n-i:n===void 0?i===void 0?e.displayName.localeCompare(t.displayName):1:-1}),{groups:e,providers:n}}),V=v(()=>l.selectedModel?.provider||l.selectedModel?.providerType||null),H=t=>e({id:t.id,provider:t.provider}),U=v(()=>l.selectedModel?H(l.selectedModel):``),W=()=>{F?.querySelector(`.solid-model-item.selected`)?.scrollIntoView({behavior:`smooth`,block:`center`})};c(i(()=>l.menuOpen,(e,t)=>{e&&!t&&(V()&&u()===`all`&&f(`frequently-used`),requestAnimationFrame(()=>{requestAnimationFrame(W)})),e||f(`all`)},{defer:!0}));let G=v(()=>{let e=u(),t=B().groups,n=V();return e===`all`?l.availableModels:e===`frequently-used`&&n?t[n]||[]:t[e]||[]}),K=()=>{if(!P)return;let{scrollLeft:e,scrollWidth:t,clientWidth:n}=P;T(e>0),O(e+n<t-1)},q=e=>{P&&(e.preventDefault(),P.scrollLeft+=e.deltaY*3,K())},J=e=>{P&&(A(!0),M(e.pageX-P.offsetLeft),te(P.scrollLeft),P.style.cursor=`grabbing`)},Y=e=>{if(!k()||!P)return;e.preventDefault();let t=(e.pageX-P.offsetLeft-j())*1.5;P.scrollLeft=N()-t},X=()=>{A(!1),P&&(P.style.cursor=`grab`)},Z=()=>{k()&&(A(!1),P&&(P.style.cursor=`grab`))},Q=e=>{if(!P)return;let t=e===`left`?P.scrollLeft-200:P.scrollLeft+200;P.scrollTo({left:t,behavior:`smooth`})};c(()=>{B(),V(),requestAnimationFrame(K)});let ne=e=>{e.target.classList.contains(`solid-dialog-backdrop`)&&l.handleMenuClose()},$=`solid-dialog-model-selector`;return c(()=>{let e=l.menuOpen,{openDialog:n,closeDialog:i}=t.getState();e?n($,l.handleMenuClose):i($),r(()=>{e&&i($)})}),y(o,{get when(){return l.menuOpen},get children(){return y(_,{get children(){var e=C(),t=e.firstChild,n=t.firstChild,r=n.firstChild.nextSibling,i=n.nextSibling,c=i.firstChild,_=c.firstChild,v=_.firstChild,b=i.nextSibling,T=b.firstChild;e.$$click=ne,p(r,`click`,l.handleMenuClose,!0),s(i,y(o,{get when(){return w()},get children(){var e=x();return e.$$click=()=>Q(`left`),e}}),c),c.addEventListener(`mouseleave`,Z),c.$$mouseup=X,c.$$mousemove=Y,c.$$mousedown=J,c.addEventListener(`wheel`,q),c.addEventListener(`scroll`,K);var O=P;typeof O==`function`?h(O,c):P=c,v.$$click=()=>f(`all`),s(_,y(o,{get when(){return m(()=>!!V())()&&B().groups[V()]},get children(){var e=S();return e.$$click=()=>f(`frequently-used`),s(e,()=>L(V())),a(()=>e.classList.toggle(`active`,u()===`frequently-used`)),e}}),null),s(_,y(d,{get each(){return B().providers.filter(e=>e.id!==V())},children:e=>(()=>{var t=S();return t.$$click=()=>f(e.id),s(t,()=>e.displayName),a(()=>t.classList.toggle(`active`,u()===e.id)),t})()}),null),s(i,y(o,{get when(){return E()},get children(){var e=ee();return e.$$click=()=>Q(`right`),e}}),null);var k=F;return typeof k==`function`?h(k,b):F=b,s(T,y(d,{get each(){return G()},children:e=>y(D,{model:e,get isSelected(){return U()===H(e)},onSelect:()=>l.handleModelSelect(e),get providerDisplayName(){return L(e.provider||e.providerType||`未知`)},get iconUrl(){return z(e)}})})),a(n=>{var r=`solid-dialog-backdrop ${l.themeMode}`,i=`solid-dialog ${l.fullScreen?`fullscreen`:``} ${l.themeMode}`,a=u()===`all`;return r!==n.e&&g(e,n.e=r),i!==n.t&&g(t,n.t=i),a!==n.a&&v.classList.toggle(`active`,n.a=a),n},{e:void 0,t:void 0,a:void 0}),e}})}})}function D(e){return(()=>{var t=T(),n=t.firstChild,r=n.firstChild,i=r.nextSibling,c=n.nextSibling.firstChild,u=c.nextSibling;return p(t,`click`,e.onSelect,!0),r.addEventListener(`error`,e=>{e.currentTarget.style.display=`none`;let t=e.currentTarget.nextElementSibling;t&&(t.style.display=`flex`)}),s(i,()=>e.providerDisplayName[0]),s(c,()=>e.model.name),s(u,()=>e.model.description||`${e.providerDisplayName}模型`),s(t,y(o,{get when(){return e.isSelected},get children(){return w()}}),null),a(n=>{var i=!!e.isSelected,a=e.iconUrl,o=e.providerDisplayName,s=!!e.isSelected;return i!==n.e&&t.classList.toggle(`selected`,n.e=i),a!==n.t&&l(r,`src`,n.t=a),o!==n.a&&l(r,`alt`,n.a=o),s!==n.o&&c.classList.toggle(`selected`,n.o=s),n},{e:void 0,t:void 0,a:void 0,o:void 0}),t})()}f([`click`,`mousedown`,`mousemove`,`mouseup`]);export{E as t};